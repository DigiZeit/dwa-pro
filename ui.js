M.ScrollView=M.View.extend({type:"M.ScrollView",render:function(){this.html='<div id="'+this.id+'" data-role="content"'+this.style()+">";this.renderChildViews();this.html+="</div>";return this.html},style:function(){var a="";if(this.cssClass)a+=' class="'+this.cssClass+'"';return a}});
M.TableView=M.View.extend({type:"M.TableView",removeContentRowsOnUpdate:YES,removeHeaderRowOnUpdate:NO,isInitialized:NO,header:null,render:function(){return this.html='<div id="'+this.id+'_container"><table id="'+this.id+'"'+this.style()+"><thead></thead><tbody></tbody></table></div>"},style:function(){var a=' class="tmp-table';if(this.cssClass)a+=" "+this.cssClass;a+='"';return a},theme:function(){this.header&&this.renderHeader()},renderHeader:function(){if(this.header&&this.header.data){if(this.header.cols&&
this.header.cols.length>0){html="<colgroup>";_.each(this.header.cols,function(a){html+='<col width="'+a+'">'});html+="</colgroup>";$("#"+this.id).prepend(html)}html="<tr>";_.each(this.header.data,function(a){html+='<th class="tmp-table-th">'+(a&&a.toString()?a.toString():"")+"</th> "});html+="</tr>";this.addRow(html,YES)}},renderUpdate:function(){var a,b=this.value;if(this.removeHeaderRowOnUpdate&&this.removeContentRowsOnUpdate)this.removeAllRows();else this.removeContentRowsOnUpdate&&this.removeContentRows();
if(b&&b.content&&b.content.length>0){if(b.header&&b.header.data){this.header=b.header;this.renderHeader()}if(b.content&&b.content.length>0){var c=this,d=0;_.each(b.content,function(h){d=d===0?1:0;a='<tr class="tmp-table-tr-'+(d===1?"a":"b")+'">';_.each(h,function(i,l){a+='<td class="tmp-table-td col_'+l+'">'+(i&&i.toString()?i.toString():"")+"</td> "});a+="</tr>";c.addRow(a)})}}else M.Logger.log("The specified content binding for the table view ("+this.id+") is invalid!",M.WARN)},addRow:function(a,
b){b?$("#"+this.id+" thead").append(a):$("#"+this.id+" tbody").append(a)},removeAllRows:function(){$("#"+this.id).empty()},removeContentRows:function(){$("#"+this.id+" tr td").parent().remove()}});
M.PageView=M.View.extend({type:"M.PageView",isFirstLoad:YES,hasTabBarView:NO,tabBarView:null,recommendedEvents:["pagebeforeshow","pageshow","pagebeforehide","pagehide","orientationdidchange"],internalEvents:null,listList:null,orientation:null,render:function(){M.ViewManager.currentlyRenderedPage=this;this.html='<div id="'+this.id+'" data-role="page"'+this.style()+">";this.renderChildViews();this.html+="</div>";this.writeToDOM();this.theme();this.registerEvents()},registerEvents:function(){this.internalEvents=
{pagebeforeshow:{target:this,action:"pageWillLoad"},pageshow:{target:this,action:"pageDidLoad"},pagebeforehide:{target:this,action:"pageWillHide"},pagehide:{target:this,action:"pageDidHide"},orientationdidchange:{target:this,action:"orientationDidChange"}};this.bindToCaller(this,M.View.registerEvents)()},writeToDOM:function(){if(restartOnBlackBerry)if(document.readyState==="loading")document.write(this.html);else typeof $(this.html)[0]!==undefined&&document.body.innerHTML.indexOf($(this.html)[0].id)===
-1&&$("body").append(this.html);else document.write(this.html)},pageWillLoad:function(a,b,c){if(M.Application.isFirstLoad){M.Application.isFirstLoad=NO;var d=M.ViewManager.getCurrentPage();if(d&&d.hasTabBarView){var h=d.tabBarView;if(h.childViews){var i=h.getChildViewsAsArray(),l;for(l in i)M.ViewManager.getPage(h[i[l]].page).id===d.id&&h.setActiveTab(h[i[l]])}}}M.LoaderView&&M.LoaderView.initialize();$("#"+a).find('[data-role="controlgroup"]').each(function(){var n=this;window.setTimeout(function(){$(n).controlgroup()},
1)});document.title=M.Application.name;c&&M.EventDispatcher.callHandler(c,b,NO,[this.isFirstLoad])},pageDidLoad:function(a,b,c){c&&M.EventDispatcher.callHandler(c,b,NO,[this.isFirstLoad]);this.isFirstLoad=NO},pageWillHide:function(a,b,c){c&&M.EventDispatcher.callHandler(c,b,NO,[this.isFirstLoad])},pageDidHide:function(a,b,c){this.listList&&_.each(this.listList,function(d){d.resetActiveListItem()});c&&M.EventDispatcher.callHandler(c,b,NO,[this.isFirstLoad])},orientationDidChange:function(a,b,c){a=
M.Environment.getOrientation();if(a!==this.orientation){$(".tmp-dialog").each(function(){var d=$(this).attr("id"),h=M.ViewManager.getViewById(d),i=$(this);window.setTimeout(function(){h.positionDialog(i);h.positionBackground($(".tmp-dialog-background"))},500)});$("#"+this.id+" .tmp-carousel-wrapper").each(function(){M.ViewManager.getViewById($(this).attr("id")).orientationDidChange()});this.orientation=a;c&&M.EventDispatcher.callHandler(c,b,NO,[M.Environment.getOrientation()])}},theme:function(){$("#"+
this.id).page();this.themeChildViews()},style:function(){var a="";if(this.cssClass){a||(a+=' class="');a+=this.cssClass}if(a)a+='"';return a}});
M.ToggleView=M.View.extend({type:"M.ToggleView",isInFirstState:YES,toggleOnClick:NO,currentView:null,render:function(){this.html='<div id="'+this.id+'">';this.renderChildViews();this.html+="</div>";return this.html},renderChildViews:function(){if(this.childViews){var a=this.getChildViewsAsArray();if(a.length!==2)M.Logger.log("M.ToggleView requires exactly 2 child views, but "+a.length+" are given ("+(this.name?this.name+", ":"")+this.id+")!",M.WARN);else{for(var b in a)if(this[a[b]]){if(this.toggleOnClick)this[a[b]].internalEvents=
{vclick:{target:this,action:"toggleView"}};this[a[b]]._name=a[b];this[a[b]].parentView=this;this.html+='<div id="'+this.id+"_"+b+'">';this.html+=this[a[b]].render();this.html+="</div>"}this.currentView=this[a[0]]}}},toggleView:function(a,b,c){a=(this.isInFirstState=!this.isInFirstState)?0:1;$("#"+this.id+"_"+(a>0?0:1)).hide();$("#"+this.id+"_"+a).show();var d=this.getChildViewsAsArray();if(this[d[a]])this.currentView=this[d[a]];c&&M.EventDispatcher.callHandler(c,b,YES)},setView:function(a){if(typeof a===
"string"){var b=this.getChildViewsAsArray();a=_.indexOf(b,a)>=0?this[a]:M.ViewManager.getViewById(a)?M.ViewManager.getViewById(a):a}if(a&&typeof a==="object"&&a.parentView===this)this.currentView!==a&&this.toggleView();else M.Logger.log("No valid view passed for toggle view '"+this._name+"'.",M.WARN)},theme:function(){if(this.currentView){this.themeChildViews();$("#"+this.id+"_"+((this.isInFirstState?0:1)>0?0:1)).hide()}}});M.HORIZONTAL="horizontal";M.VERTICAL="vertical";
M.ButtonGroupView=M.View.extend({type:"M.ButtonGroupView",direction:M.HORIZONTAL,isInset:YES,isCompact:YES,buttonsPerLine:null,numberOfLines:null,currentLine:null,lines:null,activeButton:null,isSelectable:YES,recommendedEvents:["change"],render:function(){if(this.childViews){var a=this.getChildViewsAsArray();if(this.buttonsPerLine&&this.buttonsPerLine<a.length){var b=0,c;for(c in a)if(this[a[c]]&&this[a[c]].type==="M.ButtonView")b+=1;if(this.buttonsPerLine<b)this.numberOfLines=M.Math.round(b/this.buttonsPerLine,
M.FLOOR)}}this.html="";if(this.numberOfLines){this.direction=M.HORIZONTAL;this.html+='<div id="'+this.id+'"';this.html+=this.style();this.html+=">";this.lines=[];for(c=0;c<this.numberOfLines;c++){this.currentLine=c+1;this.lines.push(this.id+"_"+c);this.html+='<div data-role="controlgroup" href="#" id="'+this.id+"_"+c+'" data-type="'+this.direction+'"';if(!this.isInset||this.isCompact)if(c==0)this.html+=this.isInset?' style="margin-bottom:0px"':' style="margin:0px"';else if(c>0&&c<this.numberOfLines-
1)this.html+=this.isInset?' style="margin:0px 0px 0px 0px"':' style="margin:0px"';else if(c<this.numberOfLines)this.html+=this.isInset?' style="margin-top:0px"':' style="margin:0px"';this.html+=">";this.renderChildViews();this.html+="</div>"}}else{this.html+='<div data-role="controlgroup" href="#" id="'+this.id+'" data-type="'+this.direction+'"'+this.style()+">";this.renderChildViews()}this.html+="</div>";return this.html},renderChildViews:function(){if(this.childViews){var a=this.getChildViewsAsArray(),
b=0,c;for(c in a)if(this[a[c]]&&this[a[c]].type==="M.ButtonView"){b+=1;if(!this.numberOfLines||M.Math.round(b/this.buttonsPerLine,M.CEIL)===this.currentLine){var d=this[a[c]];d.html="";d.parentView=this;d.internalEvents={tap:{target:this,action:"buttonSelected"}};if(this.direction===M.HORIZONTAL)d.cssStyle="margin-right:-2px;width:"+100/(this.numberOfLines?this.buttonsPerLine:a.length)+"%";this[a[c]]._name=a[c];this.html+=this[a[c]].render()}}else M.Logger.log("childview of button group is no button.",
M.WARN)}},theme:function(){if(this.numberOfLines)for(var a in this.lines){a=parseInt(a);$("#"+this.lines[a]).controlgroup();var b=this.getChildViewsAsArray(),c=0;if(this.isCompact)for(var d in b){d=parseInt(d);if(this[b[d]]&&this[b[d]].type==="M.ButtonView"){c+=1;var h=M.Math.round(c/this.buttonsPerLine,M.CEIL)-1,i=this[b[d]];if(a===h)if(a===0&&this.numberOfLines>1)if(c===1){$("#"+i.id).removeClass("ui-corner-left");this.isInset&&$("#"+i.id).addClass("ui-corner-tl")}else{if(c===this.buttonsPerLine){$("#"+
i.id).removeClass("ui-corner-right");this.isInset&&$("#"+i.id).addClass("ui-corner-tr")}}else if(a===this.numberOfLines-1)if(c===h*this.buttonsPerLine+1){$("#"+i.id).removeClass("ui-corner-left");$("#"+i.id).addClass("ui-corner-bl")}else{if(c===(h+1)*this.buttonsPerLine){$("#"+i.id).removeClass("ui-corner-right");$("#"+i.id).addClass("ui-corner-br")}}else if(c===h*this.buttonsPerLine+1)$("#"+i.id).removeClass("ui-corner-left");else c===(h+1)*this.buttonsPerLine&&$("#"+i.id).removeClass("ui-corner-right")}}}else $("#"+
this.id).controlgroup();if(this.childViews){b=this.getChildViewsAsArray();for(d in b)if(this[b[d]]&&this[b[d]].type==="M.ButtonView"){i=this[b[d]];i.isActive&&this.setActiveButton(i.id)}}},getActiveButton:function(){return this.activeButton},setActiveButton:function(a){if(this.isSelectable){if(this.activeButton){this.activeButton.removeCssClass("ui-btn-active");this.activeButton.isActive=NO}var b=this[a];b||(b=M.ViewManager.getViewById(a));if(!b)if(a&&typeof a==="object"&&a.type==="M.ButtonView")b=
a;if(b){b.addCssClass("ui-btn-active");b.isActive=YES;this.activeButton=b}}},setActiveButtonAtIndex:function(a){if(this.childViews)(a=this[this.getChildViewsAsArray()[a]])&&a.type==="M.ButtonView"&&this.setActiveButton(a)},buttonSelected:function(a,b,c){if(!(M.ViewManager.getViewById(a)&&M.ViewManager.getViewById(a).type==="M.ButtonView"&&!M.ViewManager.getViewById(a).isEnabled)){if(!(this.activeButton&&this.activeButton===M.ViewManager.getViewById(a))){if(this.isSelectable){if(this.activeButton){this.activeButton.removeCssClass("ui-btn-active");
this.activeButton.isActive=NO}var d=M.ViewManager.getViewById(a);if(!d)if(a&&typeof a==="object"&&a.type==="M.ButtonView")d=a;if(d){d.addCssClass("ui-btn-active");d.isActive=YES;this.activeButton=d}}$("#"+this.id).trigger("change")}c&&M.EventDispatcher.callHandler(c,b,YES)}},style:function(){var a="";if(this.numberOfLines&&!this.isInset)a+=' class="ui-listview';if(this.cssClass)a+=a!==""?" "+this.cssClass:' class="'+this.cssClass;a+='"';return a}});M.CAROUSEL_SIZE_CONTENT=1;
M.CAROUSEL_SIZE_SURROUNDING_ELEMENT=2;M.CAROUSEL_SIZE_NONE=3;
M.CarouselView=M.View.extend({type:"M.CarouselView",numOfThemeCalls:0,lastWidth:0,recommendedEvents:["change"],iScroll:null,activeItem:1,numItems:0,isInitialized:NO,showPaginator:YES,direction:M.HORIZONTAL,sizeCalculator:M.CAROUSEL_SIZE_CONTENT,render:function(){this.html='<div id="'+this.id+'" class="tmp-carousel-wrapper">';this.html+='<div class="tmp-carousel-scroller">';this.html+='<ul class="tmp-carousel-list">';this.childViews&&this.renderChildViews();this.html+="</ul>";this.html+="</div>";this.html+=
"</div>";if(this.showPaginator)this.html+='<div id="'+this.id+'_paginator" class="tmp-carousel-paginator tmp-carousel-paginator-'+this.direction+'"></div>';this.html+='<div class="tmp-carousel-clear"></div>';return this.html},registerEvents:function(){this.internalEvents={change:{target:this,action:"prepareExternalCallback"}};this.bindToCaller(this,M.View.registerEvents)()},prepareExternalCallback:function(a,b,c){if(c){a=M.ViewManager.getViewById($("#"+this.id+" .tmp-carousel-list li:nth-child("+
this.activeItem+")").attr("id"));M.EventDispatcher.callHandler(c,b,NO,[a,this.activeItem-1])}},renderUpdate:function(){if(this.contentBinding&&this.value){this.removeAllItems();var a="",b;for(b in this.value)a+=this.value[b].render();this.numItems=this.value.length;this.addItems(a);for(b in this.value){this.value[b].theme();this.value[b].registerEvents()}var c=this;window.setTimeout(function(){c.isInitialized=NO;c.initThemeUpdate(YES)},1)}},addItems:function(a){$("#"+this.id+" .tmp-carousel-list").append(a)},
removeAllItems:function(){$("#"+this.id+" .tmp-carousel-list").empty();$("#"+this.id+" .tmp-carousel-list").attr("style","");$("#"+this.id+" .tmp-carousel-list").unbind();$("#"+this.id+" .tmp-carousel-scroller").attr("style","");$("#"+this.id+" .tmp-carousel-scroller").unbind();$("#"+this.id).attr("style","");$("#"+this.id).unbind()},renderChildViews:function(){if(this.childViews){var a=this.getChildViewsAsArray(),b=0,c;for(c in a){var d=this[a[c]];if(d.type==="M.CarouselItemView"){d.parentView=this;
d._name=a[c];this.html+=d.render();b++}else M.Logger.log("Invalid child views specified for M.CarouselView. Only M.CarouselItemView accepted.",M.WARN)}this.numItems=b}else this.contentBinding||M.Logger.log("No child views specified for the carousel view.",M.WARN)},theme:function(){var a=this;if($("#"+this.id).parent()&&$("#"+this.id).parent().length>0)if(!(this.numOfThemeCalls>=200))if(parseInt($("#"+this.id).css("opacity"))>0||$("#"+this.id).parent().width()===0||$("#"+this.id).parent().width()===
this.lastWidth){window.setTimeout(function(){a.theme()},25);this.numOfThemeCalls++}else window.setTimeout(function(){a.lastWidth=$("#"+a.id).parent().width();var b=$("#"+a.id).parent().outerWidth(),c=0;if(a.sizeCalculator===M.CAROUSEL_SIZE_CONTENT)$("#"+a.id+" ul.tmp-carousel-list li").each(function(){if(c<$(this).outerHeight())c=$(this).outerHeight()});else if(a.sizeCalculator===M.CAROUSEL_SIZE_SURROUNDING_ELEMENT)c=parseInt($("#"+a.id).parent().css("height"));$("#"+a.id).css("width",b);$("#"+a.id).css("height",
c);$("#"+a.id+" .tmp-carousel-scroller").css("width",a.direction===M.HORIZONTAL?b*a.numItems:b);$("#"+a.id+" .tmp-carousel-scroller").css("height",a.direction===M.VERTICAL?c*a.numItems:c);$("#"+a.id+" ul.tmp-carousel-list li").css("width",b);$("#"+a.id+" ul.tmp-carousel-list li").css("height",c);var d={top:-parseInt($("#"+a.id).parent().css("padding-top")),right:-parseInt($("#"+a.id).parent().css("padding-right")),bottom:-parseInt($("#"+a.id).parent().css("padding-bottom")),left:-parseInt($("#"+a.id).parent().css("padding-left"))};
_.each(d,function(i,l){switch(l){case "top":$("#"+a.id).parent().children()[0]===$("#"+a.id)[0]&&$("#"+a.id).css("margin-"+l,i);break;case "bottom":$("#"+a.id).parent().children()[$("#"+a.id).parent().children().length-1]===$("#"+a.id)[0]&&$("#"+a.id).css("margin-"+l,i);break;default:$("#"+a.id).css("margin-"+l,i)}});if(a.iScroll){a.iScroll.refresh();a.iScroll.scrollToElement("li:nth-child("+(a.activeItem>1?a.activeItem:1)+")",100)}else a.iScroll=new iScroll(a.id,{snap:true,momentum:false,hScrollbar:false,
vScrollbar:false,onScrollEnd:function(){var i=null;if(a.direction===M.HORIZONTAL){i=parseInt($("#"+a.id+" ul.tmp-carousel-list li").css("width"));i=Math.abs(Math.floor(a.iScroll.x/i))+1}else{i=parseInt($("#"+a.id+" ul.tmp-carousel-list li").css("height"));i=Math.abs(Math.ceil(a.iScroll.y/i))+1}if(i!==a.activeItem){$("#"+a.id+"_paginator_"+a.activeItem).removeClass("tmp-carousel-paginator-item-active");a.activeItem=i;$("#"+a.id+"_paginator_"+a.activeItem).addClass("tmp-carousel-paginator-item-active")}$("#"+
a.id).trigger("change")}});var h=$("#"+a.id+"_paginator");h.css("opacity",0);window.setTimeout(function(){if(!h.html()){for(var i="",l=1;l<=a.numItems;l++)i+='<div id="'+a.id+"_paginator_"+l+'" class="tmp-carousel-paginator-item'+(l===a.activeItem?" tmp-carousel-paginator-item-active":"")+'"></div>';h.html(i)}if(a.direction===M.HORIZONTAL){h.css("width",b);h.css("top",$("#"+a.id).position().top+parseInt($("#"+a.id+" .tmp-carousel-scroller").css("height"))-parseInt($("#"+a.id+"_paginator").css("height")))}else h.css("top",
$("#"+a.id).position().top+(parseInt($("#"+a.id).css("height"))-parseInt(h.height()))/2);h.css("margin-top",d.top);h.animate({opacity:1},100)},500);$("#"+a.id).animate({opacity:1},100);a.isInitialized=YES},100)},orientationDidChange:function(){this.isInitialized=NO;this.initThemeUpdate()},initThemeUpdate:function(a){if(!this.isInitialized){if(a){this.lastWidth=0;$("#"+this.id+"_paginator").html("")}this.numOfThemeCalls=0;$("#"+this.id).css("opacity",0);$("#"+this.id+"_paginator").css("opacity",0);
var b=this;window.setTimeout(function(){b.theme()},100)}},setActiveItem:function(a){if((a=typeof a==="string"?M.ViewManager.getViewById(a):a)&&a.type==="M.CarouselItemView"){var b=M.ViewManager.getViewById($("#"+this.id+" .tmp-carousel-list li.tmp-carousel-item:nth-child("+this.activeItem+")").attr("id"));if(b&&b.id===a.id)M.Logger.log("The given carousel item already is active, so we do nothing.",M.INFO);else{$("#"+this.id+"_paginator_"+this.activeItem).removeClass("tmp-carousel-paginator-item-active");
this.activeItem=1;var c=this;$("#"+this.id+" .tmp-carousel-list li.tmp-carousel-item").each(function(){if($(this).attr("id")!==a.id)c.activeItem++;else return false});$("#"+this.id+"_paginator_"+this.activeItem).addClass("tmp-carousel-paginator-item-active");this.iScroll.scrollToElement("li.tmp-carousel-item:nth-child("+(this.activeItem>1?this.activeItem:1)+")",100)}}else M.Logger.log("No valid carousel item passed to be set active. Must be either valid id or item object of type M.CarouselItemView.",
M.WARN)},next:function(){var a=$("#"+this.id+" .tmp-carousel-list li:nth-child("+this.activeItem+")").next();a.length===0?M.Logger.log("There is no next item available. You already reached the end of the carousel.",M.INFO):this.setActiveItem(M.ViewManager.getViewById(a.attr("id")))},prev:function(){var a=$("#"+this.id+" .tmp-carousel-list li:nth-child("+this.activeItem+")").prev();a.length===0?M.Logger.log("There is no previous item available. You already reached the start of the carousel.",M.INFO):
this.setActiveItem(M.ViewManager.getViewById(a.attr("id")))}});
(function(){var a=Math,b=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":/trident/i.test(navigator.userAgent)?"ms":"opera"in window?"O":"",c=/android/gi.test(navigator.appVersion),d=/iphone|ipad/gi.test(navigator.appVersion),h=/playbook/gi.test(navigator.appVersion),i=/hp-tablet/gi.test(navigator.appVersion),l="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,n="ontouchstart"in window&&!i,x=b+"Transform"in document.documentElement.style,C=d||h,D=function(){return window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(f){return setTimeout(f,1)}}(),B=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,y="onorientationchange"in window?"orientationchange":"resize",z=n?"touchstart":"mousedown",
u=n?"touchmove":"mousemove",v=n?"touchend":"mouseup",w=n?"touchcancel":"mouseup",A="Moz"==b?"DOMMouseScroll":"mousewheel",s="translate"+(l?"3d(":"("),t=l?",0)":")";h=function(f,e){var g=this,j;g.wrapper="object"==typeof f?f:document.getElementById(f);g.wrapper.style.overflow="hidden";g.scroller=g.wrapper.children[0];g.options={hScroll:true,vScroll:true,x:0,y:0,bounce:true,bounceLock:false,momentum:true,lockDirection:true,useTransform:true,useTransition:false,topOffset:0,checkDOMChanges:false,hScrollbar:true,
vScrollbar:true,fixedScrollbar:c,hideScrollbar:d,fadeScrollbar:d&&l,scrollbarClass:"",zoom:false,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:false,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(k){k.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(j in e)g.options[j]=e[j];g.x=g.options.x;g.y=g.options.y;g.options.useTransform=
x?g.options.useTransform:false;g.options.hScrollbar=g.options.hScroll&&g.options.hScrollbar;g.options.vScrollbar=g.options.vScroll&&g.options.vScrollbar;g.options.zoom=g.options.useTransform&&g.options.zoom;g.options.useTransition=C&&g.options.useTransition;g.options.zoom&&c&&(s="translate(",t=")");g.scroller.style[b+"TransitionProperty"]=g.options.useTransform?"-"+b.toLowerCase()+"-transform":"top left";g.scroller.style[b+"TransitionDuration"]="0";g.scroller.style[b+"TransformOrigin"]="0 0";g.options.useTransition&&
(g.scroller.style[b+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)");g.options.useTransform?g.scroller.style[b+"Transform"]=s+g.x+"px,"+g.y+"px"+t:g.scroller.style.cssText+=";position:absolute;top:"+g.y+"px;left:"+g.x+"px";g.options.useTransition&&(g.options.fixedScrollbar=true);g.refresh();g._bind(y,window);g._bind(z);n||(g._bind("mouseout",g.wrapper),"none"!=g.options.wheelAction&&g._bind(A));g.options.checkDOMChanges&&(g.checkDOMTime=setInterval(function(){g._checkDOMChanges()},500))};
h.prototype={enabled:true,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(f){switch(f.type){case z:if(!n&&0!==f.button)break;this._start(f);break;case u:this._move(f);break;case v:case w:this._end(f);break;case y:this._resize();break;case A:this._wheel(f);break;case "mouseout":this._mouseout(f);break;case "webkitTransitionEnd":this._transitionEnd(f)}},_checkDOMChanges:function(){!this.moved&&!this.zoomed&&!(this.animating||this.scrollerW==
this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)&&this.refresh()},_scrollbar:function(f){var e=document,g;this[f+"Scrollbar"]?(this[f+"ScrollbarWrapper"]||(g=e.createElement("div"),this.options.scrollbarClass?g.className=this.options.scrollbarClass+f.toUpperCase():g.style.cssText="position:absolute;z-index:100;"+("h"==f?"height:7px;bottom:1px;left:2px;right:"+(this.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(this.hScrollbar?"7":"2")+"px;top:2px;right:1px"),
g.style.cssText+=";pointer-events:none;-"+b+"-transition-property:opacity;-"+b+"-transition-duration:"+(this.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(this.options.hideScrollbar?"0":"1"),this.wrapper.appendChild(g),this[f+"ScrollbarWrapper"]=g,g=e.createElement("div"),this.options.scrollbarClass||(g.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+b+"-background-clip:padding-box;-"+b+"-box-sizing:border-box;"+("h"==
f?"height:100%":"width:100%")+";-"+b+"-border-radius:3px;border-radius:3px"),g.style.cssText+=";pointer-events:none;-"+b+"-transition-property:-"+b+"-transform;-"+b+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+b+"-transition-duration:0;-"+b+"-transform:"+s+"0,0"+t,this.options.useTransition&&(g.style.cssText+=";-"+b+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),this[f+"ScrollbarWrapper"].appendChild(g),this[f+"ScrollbarIndicator"]=g),"h"==f?(this.hScrollbarSize=this.hScrollbarWrapper.clientWidth,
this.hScrollbarIndicatorSize=a.max(this.hScrollbarSize*this.hScrollbarSize/this.scrollerW>>0,8),this.hScrollbarIndicator.style.width=this.hScrollbarIndicatorSize+"px",this.hScrollbarMaxScroll=this.hScrollbarSize-this.hScrollbarIndicatorSize,this.hScrollbarProp=this.hScrollbarMaxScroll/this.maxScrollX):(this.vScrollbarSize=this.vScrollbarWrapper.clientHeight,this.vScrollbarIndicatorSize=a.max(this.vScrollbarSize*this.vScrollbarSize/this.scrollerH>>0,8),this.vScrollbarIndicator.style.height=this.vScrollbarIndicatorSize+
"px",this.vScrollbarMaxScroll=this.vScrollbarSize-this.vScrollbarIndicatorSize,this.vScrollbarProp=this.vScrollbarMaxScroll/this.maxScrollY),this._scrollbarPos(f,true)):this[f+"ScrollbarWrapper"]&&(x&&(this[f+"ScrollbarIndicator"].style[b+"Transform"]=""),this[f+"ScrollbarWrapper"].parentNode.removeChild(this[f+"ScrollbarWrapper"]),this[f+"ScrollbarWrapper"]=null,this[f+"ScrollbarIndicator"]=null)},_resize:function(){var f=this;setTimeout(function(){f.refresh()},c?200:0)},_pos:function(f,e){f=this.hScroll?
f:0;e=this.vScroll?e:0;this.options.useTransform?this.scroller.style[b+"Transform"]=s+f+"px,"+e+"px"+t+" scale("+this.scale+")":(f>>=0,e>>=0,this.scroller.style.left=f+"px",this.scroller.style.top=e+"px");this.x=f;this.y=e;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(f,e){var g="h"==f?this.x:this.y;this[f+"Scrollbar"]&&(g*=this[f+"ScrollbarProp"],0>g?(this.options.fixedScrollbar||(g=this[f+"ScrollbarIndicatorSize"]+(3*g>>0),8>g&&(g=8),this[f+"ScrollbarIndicator"].style["h"==
f?"width":"height"]=g+"px"),g=0):g>this[f+"ScrollbarMaxScroll"]&&(this.options.fixedScrollbar||(g=this[f+"ScrollbarIndicatorSize"]-(3*(g-this[f+"ScrollbarMaxScroll"])>>0),8>g&&(g=8),this[f+"ScrollbarIndicator"].style["h"==f?"width":"height"]=g+"px",g=this[f+"ScrollbarMaxScroll"]+(this[f+"ScrollbarIndicatorSize"]-g))),this[f+"ScrollbarWrapper"].style[b+"TransitionDelay"]="0",this[f+"ScrollbarWrapper"].style.opacity=e&&this.options.hideScrollbar?"0":"1",this[f+"ScrollbarIndicator"].style[b+"Transform"]=
s+("h"==f?g+"px,0":"0,"+g+"px")+t)},_start:function(f){var e=n?f.touches[0]:f,g,j;if(this.enabled){this.options.onBeforeScrollStart&&this.options.onBeforeScrollStart.call(this,f);(this.options.useTransition||this.options.zoom)&&this._transitionTime(0);this.zoomed=this.animating=this.moved=false;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;this.options.zoom&&n&&1<f.touches.length&&(j=a.abs(f.touches[0].pageX-f.touches[1].pageX),g=a.abs(f.touches[0].pageY-f.touches[1].pageY),
this.touchesDistStart=a.sqrt(j*j+g*g),this.originX=a.abs(f.touches[0].pageX+f.touches[1].pageX-2*this.wrapperOffsetLeft)/2-this.x,this.originY=a.abs(f.touches[0].pageY+f.touches[1].pageY-2*this.wrapperOffsetTop)/2-this.y,this.options.onZoomStart&&this.options.onZoomStart.call(this,f));if(this.options.momentum&&(this.options.useTransform?(g=getComputedStyle(this.scroller,null)[b+"Transform"].replace(/[^0-9-.,]/g,"").split(","),j=1*g[4],g=1*g[5]):(j=1*getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,
""),g=1*getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")),j!=this.x||g!=this.y)){this.options.useTransition?this._unbind("webkitTransitionEnd"):B(this.aniTime);this.steps=[];this._pos(j,g)}this.absStartX=this.x;this.absStartY=this.y;this.startX=this.x;this.startY=this.y;this.pointX=e.pageX;this.pointY=e.pageY;this.startTime=f.timeStamp||Date.now();this.options.onScrollStart&&this.options.onScrollStart.call(this,f);this._bind(u);this._bind(v);this._bind(w)}},_move:function(f){var e=
n?f.touches[0]:f,g=e.pageX-this.pointX,j=e.pageY-this.pointY,k=this.x+g,m=this.y+j,o=f.timeStamp||Date.now();this.options.onBeforeScrollMove&&this.options.onBeforeScrollMove.call(this,f);if(this.options.zoom&&n&&1<f.touches.length){k=a.abs(f.touches[0].pageX-f.touches[1].pageX);m=a.abs(f.touches[0].pageY-f.touches[1].pageY);this.touchesDist=a.sqrt(k*k+m*m);this.zoomed=true;e=1/this.touchesDistStart*this.touchesDist*this.scale;e<this.options.zoomMin?e=0.5*this.options.zoomMin*Math.pow(2,e/this.options.zoomMin):
e>this.options.zoomMax&&(e=2*this.options.zoomMax*Math.pow(0.5,this.options.zoomMax/e));this.lastScale=e/this.scale;k=this.originX-this.originX*this.lastScale+this.x;m=this.originY-this.originY*this.lastScale+this.y;this.scroller.style[b+"Transform"]=s+k+"px,"+m+"px"+t+" scale("+e+")";this.options.onZoom&&this.options.onZoom.call(this,f)}else{this.pointX=e.pageX;this.pointY=e.pageY;if(0<k||k<this.maxScrollX)k=this.options.bounce?this.x+g/2:0<=k||0<=this.maxScrollX?0:this.maxScrollX;if(m>this.minScrollY||
m<this.maxScrollY)m=this.options.bounce?this.y+j/2:m>=this.minScrollY||0<=this.maxScrollY?this.minScrollY:this.maxScrollY;this.distX+=g;this.distY+=j;this.absDistX=a.abs(this.distX);this.absDistY=a.abs(this.distY);6>this.absDistX&&6>this.absDistY||(this.options.lockDirection&&(this.absDistX>this.absDistY+5?(m=this.y,j=0):this.absDistY>this.absDistX+5&&(k=this.x,g=0)),this.moved=true,this._pos(k,m),this.dirX=0<g?-1:0>g?1:0,this.dirY=0<j?-1:0>j?1:0,300<o-this.startTime&&(this.startTime=o,this.startX=
this.x,this.startY=this.y),this.options.onScrollMove&&this.options.onScrollMove.call(this,f))}},_end:function(f){if(!(n&&0!=f.touches.length)){var e=this,g=n?f.changedTouches[0]:f,j,k,m={dist:0,time:0},o={dist:0,time:0},q=(f.timeStamp||Date.now())-e.startTime,p=e.x,r=e.y;e._unbind(u);e._unbind(v);e._unbind(w);e.options.onBeforeScrollEnd&&e.options.onBeforeScrollEnd.call(e,f);if(e.zoomed){p=e.scale*e.lastScale;p=Math.max(e.options.zoomMin,p);p=Math.min(e.options.zoomMax,p);e.lastScale=p/e.scale;e.scale=
p;e.x=e.originX-e.originX*e.lastScale+e.x;e.y=e.originY-e.originY*e.lastScale+e.y;e.scroller.style[b+"TransitionDuration"]="200ms";e.scroller.style[b+"Transform"]=s+e.x+"px,"+e.y+"px"+t+" scale("+e.scale+")";e.zoomed=false;e.refresh();e.options.onZoomEnd&&e.options.onZoomEnd.call(e,f)}else{if(e.moved){if(300>q&&e.options.momentum){m=p?e._momentum(p-e.startX,q,-e.x,e.scrollerW-e.wrapperW+e.x,e.options.bounce?e.wrapperW:0):m;o=r?e._momentum(r-e.startY,q,-e.y,0>e.maxScrollY?e.scrollerH-e.wrapperH+e.y-
e.minScrollY:0,e.options.bounce?e.wrapperH:0):o;p=e.x+m.dist;r=e.y+o.dist;if(0<e.x&&0<p||e.x<e.maxScrollX&&p<e.maxScrollX)m={dist:0,time:0};if(e.y>e.minScrollY&&r>e.minScrollY||e.y<e.maxScrollY&&r<e.maxScrollY)o={dist:0,time:0}}m.dist||o.dist?(m=a.max(a.max(m.time,o.time),10),e.options.snap&&(o=p-e.absStartX,q=r-e.absStartY,a.abs(o)<e.options.snapThreshold&&a.abs(q)<e.options.snapThreshold?e.scrollTo(e.absStartX,e.absStartY,200):(o=e._snap(p,r),p=o.x,r=o.y,m=a.max(o.time,m))),e.scrollTo(p>>0,r>>0,
m)):e.options.snap?(o=p-e.absStartX,q=r-e.absStartY,a.abs(o)<e.options.snapThreshold&&a.abs(q)<e.options.snapThreshold?e.scrollTo(e.absStartX,e.absStartY,200):(o=e._snap(e.x,e.y),(o.x!=e.x||o.y!=e.y)&&e.scrollTo(o.x,o.y,o.time))):e._resetPos(200)}else{n&&(e.doubleTapTimer&&e.options.zoom?(clearTimeout(e.doubleTapTimer),e.doubleTapTimer=null,e.options.onZoomStart&&e.options.onZoomStart.call(e,f),e.zoom(e.pointX,e.pointY,1==e.scale?e.options.doubleTapZoom:1),e.options.onZoomEnd&&setTimeout(function(){e.options.onZoomEnd.call(e,
f)},200)):e.doubleTapTimer=setTimeout(function(){e.doubleTapTimer=null;for(j=g.target;1!=j.nodeType;)j=j.parentNode;"SELECT"!=j.tagName&&"INPUT"!=j.tagName&&"TEXTAREA"!=j.tagName&&(k=document.createEvent("MouseEvents"),k.initMouseEvent("click",true,true,f.view,1,g.screenX,g.screenY,g.clientX,g.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,0,null),k._fake=true,j.dispatchEvent(k))},e.options.zoom?250:0));e._resetPos(200)}e.options.onTouchEnd&&e.options.onTouchEnd.call(e,f)}}},_resetPos:function(f){var e=
0<=this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,g=this.y>=this.minScrollY||0<this.maxScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y;if(e==this.x&&g==this.y){if(this.moved&&(this.moved=false,this.options.onScrollEnd&&this.options.onScrollEnd.call(this)),this.hScrollbar&&this.options.hideScrollbar&&("webkit"==b&&(this.hScrollbarWrapper.style[b+"TransitionDelay"]="300ms"),this.hScrollbarWrapper.style.opacity="0"),this.vScrollbar&&this.options.hideScrollbar){"webkit"==
b&&(this.vScrollbarWrapper.style[b+"TransitionDelay"]="300ms");this.vScrollbarWrapper.style.opacity="0"}}else this.scrollTo(e,g,f||0)},_wheel:function(f){var e=this,g,j;if("wheelDeltaX"in f){g=f.wheelDeltaX/12;j=f.wheelDeltaY/12}else if("wheelDelta"in f)g=j=f.wheelDelta/12;else if("detail"in f)g=j=3*-f.detail;else return;if("zoom"==e.options.wheelAction){if(j=e.scale*Math.pow(2,1/3*(j?j/Math.abs(j):0)),j<e.options.zoomMin&&(j=e.options.zoomMin),j>e.options.zoomMax&&(j=e.options.zoomMax),j!=e.scale){!e.wheelZoomCount&&
e.options.onZoomStart&&e.options.onZoomStart.call(e,f);e.wheelZoomCount++;e.zoom(f.pageX,f.pageY,j,400);setTimeout(function(){e.wheelZoomCount--;!e.wheelZoomCount&&e.options.onZoomEnd&&e.options.onZoomEnd.call(e,f)},400)}}else{g=e.x+g;j=e.y+j;0<g?g=0:g<e.maxScrollX&&(g=e.maxScrollX);j>e.minScrollY?j=e.minScrollY:j<e.maxScrollY&&(j=e.maxScrollY);e.scrollTo(g,j,0)}},_mouseout:function(f){var e=f.relatedTarget;if(e)for(;e=e.parentNode;)if(e==this.wrapper)return;this._end(f)},_transitionEnd:function(f){f.target==
this.scroller&&(this._unbind("webkitTransitionEnd"),this._startAni())},_startAni:function(){var f=this,e=f.x,g=f.y,j=Date.now(),k,m,o;f.animating||(f.steps.length?(k=f.steps.shift(),k.x==e&&k.y==g&&(k.time=0),f.animating=true,f.moved=true,f.options.useTransition)?(f._transitionTime(k.time),f._pos(k.x,k.y),f.animating=false,k.time?f._bind("webkitTransitionEnd"):f._resetPos(0)):(o=function(){var q=Date.now(),p;if(q>=j+k.time){f._pos(k.x,k.y);f.animating=false;f.options.onAnimationEnd&&f.options.onAnimationEnd.call(f);
f._startAni()}else{q=(q-j)/k.time-1;m=a.sqrt(1-q*q);q=(k.x-e)*m+e;p=(k.y-g)*m+g;f._pos(q,p);if(f.animating)f.aniTime=D(o)}},o()):f._resetPos(400))},_transitionTime:function(f){f+="ms";this.scroller.style[b+"TransitionDuration"]=f;this.hScrollbar&&(this.hScrollbarIndicator.style[b+"TransitionDuration"]=f);this.vScrollbar&&(this.vScrollbarIndicator.style[b+"TransitionDuration"]=f)},_momentum:function(f,e,g,j,k){e=a.abs(f)/e;var m=e*e/0.0012;0<f&&m>g?(g+=k/(6/(6.0E-4*(m/e))),e=e*g/m,m=g):0>f&&m>j&&(j+=
k/(6/(6.0E-4*(m/e))),e=e*j/m,m=j);return{dist:m*(0>f?-1:1),time:e/6.0E-4>>0}},_offset:function(f){for(var e=-f.offsetLeft,g=-f.offsetTop;f=f.offsetParent;){e-=f.offsetLeft;g-=f.offsetTop}f!=this.wrapper&&(e*=this.scale,g*=this.scale);return{left:e,top:g}},_snap:function(f,e){var g,j,k;k=this.pagesX.length-1;g=0;for(j=this.pagesX.length;g<j;g++)if(f>=this.pagesX[g]){k=g;break}k==this.currPageX&&0<k&&0>this.dirX&&k--;f=this.pagesX[k];j=(j=a.abs(f-this.pagesX[this.currPageX]))?500*(a.abs(this.x-f)/j):
0;this.currPageX=k;k=this.pagesY.length-1;for(g=0;g<k;g++)if(e>=this.pagesY[g]){k=g;break}k==this.currPageY&&0<k&&0>this.dirY&&k--;e=this.pagesY[k];g=(g=a.abs(e-this.pagesY[this.currPageY]))?500*(a.abs(this.y-e)/g):0;this.currPageY=k;k=a.max(j,g)>>0;return{x:f,y:e,time:k||200}},_bind:function(f,e,g){(e||this.scroller).addEventListener(f,this,!!g)},_unbind:function(f,e,g){(e||this.scroller).removeEventListener(f,this,!!g)},destroy:function(){this.scroller.style[b+"Transform"]="";this.vScrollbar=this.hScrollbar=
false;this._scrollbar("h");this._scrollbar("v");this._unbind(y,window);this._unbind(z);this._unbind(u);this._unbind(v);this._unbind(w);this.options.hasTouch||(this._unbind("mouseout",this.wrapper),this._unbind(A));this.options.useTransition&&this._unbind("webkitTransitionEnd");this.options.checkDOMChanges&&clearInterval(this.checkDOMTime);this.options.onDestroy&&this.options.onDestroy.call(this)},refresh:function(){var f,e,g,j=0;e=0;this.scale<this.options.zoomMin&&(this.scale=this.options.zoomMin);
this.wrapperW=this.wrapper.clientWidth||1;this.wrapperH=this.wrapper.clientHeight||1;this.minScrollY=-this.options.topOffset||0;this.scrollerW=this.scroller.offsetWidth*this.scale>>0;this.scrollerH=(this.scroller.offsetHeight+this.minScrollY)*this.scale>>0;this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH+this.minScrollY;this.dirY=this.dirX=0;this.options.onRefresh&&this.options.onRefresh.call(this);this.hScroll=this.options.hScroll&&0>this.maxScrollX;this.vScroll=
this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);this.hScrollbar=this.hScroll&&this.options.hScrollbar;this.vScrollbar=this.vScroll&&this.options.vScrollbar&&this.scrollerH>this.wrapperH;f=this._offset(this.wrapper);this.wrapperOffsetLeft=-f.left;this.wrapperOffsetTop=-f.top;if("string"==typeof this.options.snap){this.pagesX=[];this.pagesY=[];g=this.scroller.querySelectorAll(this.options.snap);f=0;for(e=g.length;f<e;f++){j=this._offset(g[f]);j.left+=this.wrapperOffsetLeft;
j.top+=this.wrapperOffsetTop;this.pagesX[f]=j.left<this.maxScrollX?this.maxScrollX:j.left*this.scale;this.pagesY[f]=j.top<this.maxScrollY?this.maxScrollY:j.top*this.scale}}else if(this.options.snap){for(this.pagesX=[];j>=this.maxScrollX;){this.pagesX[e]=j;j-=this.wrapperW;e++}this.maxScrollX%this.wrapperW&&(this.pagesX[this.pagesX.length]=this.maxScrollX-this.pagesX[this.pagesX.length-1]+this.pagesX[this.pagesX.length-1]);e=j=0;for(this.pagesY=[];j>=this.maxScrollY;){this.pagesY[e]=j;j-=this.wrapperH;
e++}this.maxScrollY%this.wrapperH&&(this.pagesY[this.pagesY.length]=this.maxScrollY-this.pagesY[this.pagesY.length-1]+this.pagesY[this.pagesY.length-1])}this._scrollbar("h");this._scrollbar("v");this.zoomed||(this.scroller.style[b+"TransitionDuration"]="0",this._resetPos(200))},scrollTo:function(f,e,g,j){var k=f;this.stop();k.length||(k=[{x:f,y:e,time:g,relative:j}]);f=0;for(e=k.length;f<e;f++){k[f].relative&&(k[f].x=this.x-k[f].x,k[f].y=this.y-k[f].y);this.steps.push({x:k[f].x,y:k[f].y,time:k[f].time||
0})}this._startAni()},scrollToElement:function(f,e){var g;if(f=f.nodeType?f:this.scroller.querySelector(f)){g=this._offset(f);g.left+=this.wrapperOffsetLeft;g.top+=this.wrapperOffsetTop;g.left=0<g.left?0:g.left<this.maxScrollX?this.maxScrollX:g.left;g.top=g.top>this.minScrollY?this.minScrollY:g.top<this.maxScrollY?this.maxScrollY:g.top;e=void 0===e?a.max(2*a.abs(g.left),2*a.abs(g.top)):e;this.scrollTo(g.left,g.top,e)}},scrollToPage:function(f,e,g){g=void 0===g?400:g;this.options.onScrollStart&&this.options.onScrollStart.call(this);
if(this.options.snap){f="next"==f?this.currPageX+1:"prev"==f?this.currPageX-1:f;e="next"==e?this.currPageY+1:"prev"==e?this.currPageY-1:e;f=0>f?0:f>this.pagesX.length-1?this.pagesX.length-1:f;e=0>e?0:e>this.pagesY.length-1?this.pagesY.length-1:e;this.currPageX=f;this.currPageY=e;f=this.pagesX[f];e=this.pagesY[e]}else if(f*=-this.wrapperW,e*=-this.wrapperH,f<this.maxScrollX&&(f=this.maxScrollX),e<this.maxScrollY)e=this.maxScrollY;this.scrollTo(f,e,g)},disable:function(){this.stop();this._resetPos(0);
this.enabled=false;this._unbind(u);this._unbind(v);this._unbind(w)},enable:function(){this.enabled=true},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):B(this.aniTime);this.steps=[];this.animating=this.moved=false},zoom:function(f,e,g,j){var k=g/this.scale;this.options.useTransform&&(this.zoomed=true,j=void 0===j?200:j,f=f-this.wrapperOffsetLeft-this.x,e=e-this.wrapperOffsetTop-this.y,this.x=f-f*k+this.x,this.y=e-e*k+this.y,this.scale=g,this.refresh(),this.x=0<this.x?
0:this.x<this.maxScrollX?this.maxScrollX:this.x,this.y=this.y>this.minScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y,this.scroller.style[b+"TransitionDuration"]=j+"ms",this.scroller.style[b+"Transform"]=s+this.x+"px,"+this.y+"px"+t+" scale("+g+")",this.zoomed=false)},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}};"undefined"!==typeof exports?exports.iScroll=h:window.iScroll=h})();
M.SplitView=M.View.extend({type:"M.SplitView",menu:null,content:null,isInitialized:NO,selectedItem:null,orientation:null,headerheight:null,footerheight:null,itemheight:null,contentLoaded:NO,scrollviewsInitialized:NO,hasMenuScrollview:NO,shouldHaveScrollview:YES,render:function(){this.html='<div id="'+this.id+'">';this.renderChildViews();this.html+="</div>";return this.html},renderChildViews:function(){if(this.childViews||this.contentBinding)if(this.getChildViewsAsArray().length>0||this.contentBinding){this.menu=
M.ScrollView.design({childViews:"menu",menu:M.ListView.design({})});this.menu.parentView=this;this.menu.menu.parentView=this.menu;this.menu.cssClass=this.menu.cssClass?this.menu.cssClass+" tmp-splitview-menu":"tmp-splitview-menu";this.html+=this.menu.render();this.content=M.ScrollView.design({});this.content.parentView=this;this.content.cssClass=this.content.cssClass?this.content.cssClass+" tmp-splitview-content":"tmp-splitview-content";this.html+=this.content.render();return this.html}else M.Logger.log("You need to provide at least one child view for M.SplitView of the type M.SplitItemView.",
M.ERROR)},renderUpdate:function(){var a=null;if(this.contentBinding)a=this.value;else if(this.childViews){var b=this.getChildViewsAsArray();a=[];for(var c=0;c<b.length;c++)a.push(this[b[c]])}if(a)if(a.length>0){this.menu.menu.removeAllItems();b=null;var d=0;for(c in a)if(a[c]&&a[c].type==="M.SplitItemView"){var h=M.ListItemView.design({childViews:"label",parentView:this.menu.menu,splitViewItem:a[c],label:M.LabelView.design({value:a[c].value}),events:{tap:{target:this,action:"listItemSelected"}}});
this.menu.menu.addItem(h.render());h.registerEvents();if(d===0||a[c].isActive)b=h.id;d++}else M.Logger.log("Invalid child view passed! The child views of M.SplitView need to be of type M.ListView.",M.ERROR);this.menu.menu.themeUpdate();this.menu.menu.setActiveListItem(b);this.listItemSelected(b)}else M.Logger.log("You need to provide at least one child view for M.SplitView of the type M.SplitItemView.",M.ERROR)},theme:function(){this.renderUpdate();if(!this.contentLoaded){var a=this;$(document).bind("DOMContentLoaded",
function(){a.initializeVar()})}},themeUpdate:function(){var a=M.Environment.getSize(),b=a[0];a=a[1];if(M.Environment.getWidth()>M.Environment.getHeight()){this.orientation="landscape";$("html").addClass(this.orientation);$("#"+this.menu.id).css("width",Math.ceil(b*0.3)-2*parseInt($("#"+this.menu.id).css("border-right-width"))+"px");$("#"+this.content.id).css("width",Math.floor(b*0.7)-2*(parseInt($("#"+this.content.id).css("padding-right"))+parseInt($("#"+this.content.id).css("padding-left")))+"px");
$("#"+this.content.id).css("left",Math.ceil(b*0.3)+(parseInt($("#"+this.content.id).css("padding-right"))+parseInt($("#"+this.content.id).css("padding-left")))-parseInt($("#"+this.menu.id).css("border-right-width"))+"px");$(".tmp-splitview-menu-toolbar").css("width",Math.ceil(b*0.3)+(parseInt($("#"+this.content.id).css("padding-right"))+parseInt($("#"+this.content.id).css("padding-left")))-parseInt($(".tmp-splitview-menu-toolbar").css("border-right-width"))+"px");$(".tmp-splitview-content-toolbar").css("width",
Math.floor(b*0.7)-(parseInt($("#"+this.content.id).css("padding-right"))+parseInt($("#"+this.content.id).css("padding-left")))+"px")}else{this.orientation="portrait";$("html").addClass(this.orientation);$("#"+this.content.id).css("width",b-(parseInt($("#"+this.content.id).css("padding-right"))+parseInt($("#"+this.content.id).css("padding-left")))+"px");$("#"+this.content.id).css("left","0px");$(".tmp-splitview-content-toolbar").css("width",b+"px")}b=M.ViewManager.getCurrentPage()||M.ViewManager.getPage(M.Application.entryPage);
$("#"+b.id).hasClass("tmp-splitview-no-footer")?$("#"+b.id).css("min-height",a+"px"):$("#"+b.id).css("min-height",a-this.footerheight+"px !important");$("#"+b.id+" .ui-footer").length===0?$("#"+this.menu.menu.id).css("height",M.Environment.getHeight()-this.headerheight):$("#"+this.menu.menu.id).css("height",M.Environment.getHeight()-this.headerheight-this.footerheight);if(!this.scrollviewsInitialized){$("#"+this.content.id).scrollview({direction:"y"});if(this.orientation==="landscape"){this.itemheight=
$("#"+this.menu.menu.id).find("li:first").outerHeight();b=$("#"+this.menu.menu.id).find("li").length;if(this.itemheight!==0)if(M.Environment.getHeight()<b*this.itemheight){$("#"+this.menu.menu.id).scrollview({direction:"y"});this.hasMenuScrollview=YES}else this.shouldHaveScrollview=NO;this.scrollviewsInitialized=YES}}},initializeVar:function(){this.headerheight=$("#"+M.ViewManager.getCurrentPage().id+" .ui-header").height();this.footerheight=$("#"+M.ViewManager.getCurrentPage().id+" .ui-footer").height();
this.contentLoaded=YES;this.themeUpdate()},registerEvents:function(){var a=M.ViewManager.getCurrentPage()||M.ViewManager.getPage(M.Application.entryPage);M.EventDispatcher.registerEvent("orientationdidchange",a.id,{target:this,action:function(){var b=this;window.setTimeout(function(){b.orientationDidChange()},100)}},["orientationdidchange"],null,NO,YES)},listItemSelected:function(a){var b=M.ViewManager.getViewById(a)&&M.ViewManager.getViewById(a).splitViewItem?M.ViewManager.getViewById(a).splitViewItem.view:
null;if(b){this.selectedItem=M.ViewManager.getViewById(a).splitViewItem;if(this.isInitialized){if(b.html)$("#"+this.content.id+" div:first").html(b.html);else{$("#"+this.content.id+" div:first").html(b.render());b.theme();b.registerEvents()}$("#"+this.content.id).scrollview("scrollTo",0,0)}else{if(b.html)$("#"+this.content.id).html(b.html);else{$("#"+this.content.id).html(b.render());b.theme();b.registerEvents()}this.isInitialized=YES}b=M.ViewManager.getCurrentPage()||M.ViewManager.getPage(M.Application.entryPage);
var c=this;if(b){$("#"+b.id+" .tmp-splitview-content-toolbar").each(function(){var d=M.ViewManager.getViewById($(this).attr("id"));if(d.parentView&&d.parentView.showSelectedItemInMainHeader){d.value=M.ViewManager.getViewById(a).splitViewItem.value;$("#"+d.id+" h1").html(d.value);if(!d.parentView.splitview)d.parentView.splitview=c}});$("#"+b.id+" .ui-footer").length===0&&b.addCssClass("tmp-splitview-no-footer");$("#"+b.id+" .tmp-splitview-content-toolbar").length===0&&b.addCssClass("tmp-splitview-no-header")}}},
orientationDidChange:function(){M.Environment.getOrientation();var a=this,b=M.ViewManager.getCurrentPage()||M.ViewManager.getPage(M.Application.entryPage);if(M.Environment.getHeight()>M.Environment.getWidth()){$("html").removeClass("landscape");$("html").addClass("portrait")}else{$("html").removeClass("portrait");$("html").addClass("landscape");var c;b&&$("#"+b.id+" .tmp-splitview-menu-toolbar").each(function(){(c=M.ViewManager.getViewById($(this).attr("id")))&&c.parentView&&c.parentView.popover&&
c.parentView.popover.hide()});var d;$("#"+this.menu.id).find("li").each(function(){if(M.ViewManager.getViewById($(this).attr("id")).splitViewItem.id===a.selectedItem.id)d=$(this).attr("id")});d&&this.menu.menu.setActiveListItem(d);this.selectedItem=M.ViewManager.getViewById(d).splitViewItem;this.scrollListToRightPosition(d)}$("#"+this.content.id).scrollview("scrollTo",0,0);this.themeUpdate()},scrollListToRightPosition:function(a){var b=$("#"+this.menu.menu.id+" li:first-child").outerHeight();a=($("#"+
a).index()+1)*b;var c=M.Environment.getHeight()-this.headerheight-this.footerheight,d=c/2;b=$("#"+this.menu.menu.id).find("li").length*b-a;var h=0;if(a>c)h=b<d?-(a-c+b):-(a-d);else if(a<c)h=a<d?0:-(a-d);!this.hasMenuScrollview&&this.shouldHaveScrollview&&$("#"+this.menu.menu.id).scrollview({direction:"y"});$("#"+this.menu.menu.id).scrollview("scrollTo",0,h)}});
M.TabBarItemView=M.View.extend({type:"M.TabBarItemView",isActive:NO,recommendedEvents:["click","tap"],render:function(){this.html="";this.id=this.id.lastIndexOf("_")==1?this.id+"_"+this.parentView.usageCounter:this.id.substring(0,this.id.lastIndexOf("_"))+"_"+this.parentView.usageCounter;M.ViewManager.register(this);this.html+='<li><a id="'+this.id+'"'+this.style()+' href="#">'+this.value+"</a></li>";return this.html},registerEvents:function(){this.internalEvents={tap:{target:this,action:"switchPage"}};
this.bindToCaller(this,M.View.registerEvents)()},switchPage:function(){try{DigiWebApp.ApplicationController.vibrate()}catch(a){}if(this.page){M.ViewManager.setCurrentPage(M.ViewManager.getPage(this.page));M.Controller.switchToTab(this)}else this.parentView.setActiveTab(this)},style:function(){var a="";if(this.cssClass)a+=' class="'+this.cssClass+'"';if(this.isActive){a+=a!=""?"":' class="';a+="ui-btn-active";a+='"'}if(this.icon){a+=' data-icon="';a+=this.icon;a+='" data-iconpos="top"'}return a}});
M.DatePickerView=M.View.extend({type:"M.DatePickerView",source:null,callbacks:null,initialDate:null,useSourceDateAsInitialDate:YES,showDatePicker:YES,showTimePicker:YES,showLabels:YES,yearLabel:"Year",monthLabel:"Month",dayLabel:"Day",hoursLabel:"Hours",minutesLabel:"Minutes",showAmPm:YES,startYear:null,endYear:null,dateFormat:"M dd, yy",dateFormatMonthOnly:"MM yy",timeFormat:"h:ii A",dateOrder:"Mddyy",dateOrderMonthOnly:"MMyy",monthNames:["January","February","March","April","May","June","July",
"August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],cancelButtonValue:"Cancel",confirmButtonValue:"Ok",stepHour:1,stepMinute:1,stepSecond:1,seconds:NO,hasSource:YES,isValueSelected:NO,isActive:NO,show:function(a){a=M.DatePickerView.design(a);if(!Object.getPrototypeOf(a).isActive){Object.getPrototypeOf(a).isActive=
YES;if(a.showDatePicker||a.showTimePicker){this.startYear=this.startYear?this.startYear:D8.now().format("yyyy")-20;this.endYear=this.endYear?this.endYear:D8.now().format("yyyy")+20;if(a.source){a.source=typeof a.source==="object"&&a.source.type?a.source.id:a.source;var b=M.ViewManager.getViewById(a.source);b&&typeof b.setValue==="function"&&$("#"+a.source)&&$("#"+a.source).length>0?a.init():M.Logger.log("The specified source for the M.DatepickerView is invalid!",M.ERR)}else{a.hasSource=NO;if(b=M.ViewManager.getCurrentPage()){a.source=
b.id;a.init()}}}else M.Logger.log("In order to use the M.DatepickerView, you have to set the 'showDatePicker' or 'showTimePicker' property to YES.",M.ERR)}},init:function(){var a=this;$("#"+this.source).scroller({preset:this.showDatePicker&&this.showTimePicker?"datetime":this.showDatePicker?"date":this.showTimePicker?"time":null,ampm:this.showAmPm,startYear:this.startYear,endYear:this.endYear,dateFormat:this.dateFormat,timeFormat:this.timeFormat,dateOrder:this.dateOrder,dayText:this.dayLabel,hourText:this.hoursLabel,
minuteText:this.minutesLabel,monthText:this.monthLabel,yearText:this.yearLabel,monthNames:this.monthNames,monthNamesShort:this.monthNamesShort,dayNames:this.dayNames,dayNamesShort:this.dayNamesShort,cancelText:this.cancelButtonValue,setText:this.confirmButtonValue,stepHour:this.stepHour,stepMinute:this.stepMinute,stepSecond:this.stepSecond,seconds:this.seconds,width:(M.Environment.getWidth()-20)/3-20>90?90:(M.Environment.getWidth()-20)/3-20,beforeShow:function(b,c){a.bindToCaller(a,a.beforeShow,[b,
c])()},onClose:function(b,c){a.bindToCaller(a,a.onClose,[b,c])()},onSelect:function(b,c){a.bindToCaller(a,a.onSelect,[b,c])()}});$("#"+this.source).scroller("show")},beforeShow:function(a,b){var c=a=null;if(this.hasSource&&this.useSourceDateAsInitialDate){a=M.ViewManager.getViewById(this.source);if(a.value){try{c=D8.create(a.value)}catch(d){}if(c)if(c.format("yyyy")<this.startYear)if(this.hasOwnProperty("startYear"))M.Logger.log("The given date of the source ("+c.format("yyyy")+") conflicts with the 'startYear' property ("+
this.startYear+") and therefore will be ignored!",M.WARN);else{M.Logger.log("The date picker's default 'startYear' property ("+this.startYear+") conflicts with the given date of the source ("+c.format("yyyy")+") and therefore will be ignored!",M.WARN);$("#"+this.source).scroller("option","startYear",c.format("yyyy"));$("#"+this.source).scroller("setDate",c.date)}else $("#"+this.source).scroller("setDate",c.date)}}if(this.initialDate&&!c){if(this.initialDate.date)c=this.initialDate;else try{c=D8.create(this.initialDate)}catch(h){}if(c)if(c.format("yyyy")<
this.startYear)if(this.hasOwnProperty("startYear"))M.Logger.log("The specified initial date ("+c.format("yyyy")+") conflicts with the 'startYear' property ("+this.startYear+") and therefore will be ignored!",M.WARN);else{M.Logger.log("The date picker's default 'startYear' property ("+this.startYear+") conflicts with the specified initial date ("+c.format("yyyy")+") and therefore will be ignored!",M.WARN);$("#"+this.source).scroller("option","startYear",c.format("yyyy"));$("#"+this.source).scroller("setDate",
c.date)}else $("#"+this.source).scroller("setDate",c.date)}value=b.formatDate(this.showDatePicker?this.dateFormat+(this.showTimePicker?" "+this.timeFormat:""):this.timeFormat,b.getDate());$(".dwv").remove();window.setTimeout(function(){$(".dw").addClass("ui-btn-up-a")},1);$(".dwo").bind("touchmove",function(x){x.preventDefault()});var i=M.ButtonView.design({value:this.confirmButtonValue,cssClass:"b tmp-dialog-smallerbtn-confirm",events:{tap:{action:function(){$("#dw_set").trigger("click")}}}}),l=
M.ButtonView.design({value:this.cancelButtonValue,cssClass:"d tmp-dialog-smallerbtn-confirm",events:{tap:{action:function(){$("#dw_cancel").trigger("click")}}}});if(this.showDatePicker){i=M.GridView.design({childViews:"confirm cancel",layout:M.TWO_COLUMNS,cssClass:"tmp-datepicker-buttongrid",confirm:i,cancel:l});var n=i.render();$(".dw").append(n);i.theme();i.registerEvents()}else{n=i.render();n+=l.render();$(".dw").append(n);i.theme();i.registerEvents();l.theme();l.registerEvents()}$("#dw_cancel").hide();
$("#dw_set").hide();this.showLabels||$("body").addClass("tmp-datepicker-no-label");this.callbacks&&this.callbacks.before&&M.EventDispatcher.checkHandler(this.callbacks.before)&&M.EventDispatcher.callHandler(this.callbacks.before,null,NO,[value,c])},onClose:function(a,b){var c=null,d=null;if(this.isValueSelected){try{d=D8.create(b.getDate())}catch(h){}if(this.hasSource)(c=M.ViewManager.getViewById(this.source))&&c.setValue(a,NO,YES)}this.showLabels||$("body").removeClass("tmp-datepicker-no-label");
if(!this.isValueSelected&&this.callbacks&&this.callbacks.cancel&&M.EventDispatcher.checkHandler(this.callbacks.cancel))M.EventDispatcher.callHandler(this.callbacks.cancel,null,NO,[]);else this.isValueSelected&&this.callbacks&&this.callbacks.confirm&&M.EventDispatcher.checkHandler(this.callbacks.confirm)&&M.EventDispatcher.callHandler(this.callbacks.confirm,null,NO,[a,d]);Object.getPrototypeOf(this).isActive=NO;$("#"+this.source).scroller("destroy");$(".dwo").remove();$(".dw").remove();this.destroy()},
onSelect:function(){this.isValueSelected=YES}});
M.SplitToolbarView=M.View.extend({type:"M.SplitToolbarView",showSelectedItemInMainHeader:YES,showMenuButtonInPortraitMode:YES,popover:null,splitview:null,renderChildViews:function(){if(this.childViews){var a=$.trim(this.childViews).split(" "),b=0,c;for(c in a){var d=this[a[c]];if(d&&d.type==="M.ToolbarView"){d.parentView=this;if(b===0)d.cssClass=d.cssClass?d.cssClass+" tmp-splitview-menu-toolbar":"tmp-splitview-menu-toolbar";else if(b===1){d.cssClass=d.cssClass?d.cssClass+" tmp-splitview-content-toolbar":
"tmp-splitview-content-toolbar";if(!d.childViews&&this.showMenuButtonInPortraitMode){d.cssClass=d.cssClass?d.cssClass+" tmp-splitview-content-toolbar-show-menu-button":"tmp-splitview-content-toolbar-show-menu-button";d.childViews="menuButton label";d.menuButton=M.ButtonView.design({value:this[a[0]].value,icon:"arrow-d",anchorLocation:M.LEFT,internalEvents:{tap:{target:this,action:function(){if(this.popover){this.popover.renderUpdate();this.popover.toggle()}else{var h;if(this.splitview.contentBinding)h=
this.splitview.value;else if(this.splitview.childViews){var i=this.splitview.getChildViewsAsArray();h=[];for(var l=0;l<i.length;l++)h.push(this.splitview[i[l]])}i=[];for(l in h)i.push(h[l]);this.popover=M.PopoverView.design({items:i,splitview:this.splitview});this.popover.show()}}}}});d.label=M.LabelView.design({value:d.value,anchorLocation:M.CENTER});d.value=""}}else{M.Logger.log("Too many child views given! M.SplitToolbarView only accepts two child views of type M.ToolbarView.",M.ERROR);return}this.html+=
d.render();b++}else M.Logger.log(a[c]+" must be of type M.ToolbarView.",M.ERROR)}return this.html}}});
M.LoaderView=M.View.extend({type:"M.LoaderView",isInitialized:NO,refCount:0,defaultTitle:"loading",initialize:function(){if(!this.isInitialized){this.refCount=0;$.mobile.showPageLoadingMsg();$.mobile.hidePageLoadingMsg();this.isInitialized=YES}},show:function(a,b){this.refCount++;a=a&&typeof a==="string"?a:this.defaultTitle;if(this.refCount==1){$.mobile.showPageLoadingMsg("a",a,b);var c=$(".ui-loader");c.removeClass("ui-loader-default");c.addClass("ui-loader-verbose");var d=M.Environment.getSize(),
h=window.pageYOffset,i=c.outerHeight();c.css("top",h+d[1]/2+"px");c.css("margin-top","-"+i/2+"px")}},changeTitle:function(a){$(".ui-loader h1").html(a)},hide:function(a){if(a||this.refCount<=0)this.refCount=0;else this.refCount--;this.refCount==0&&$.mobile.hidePageLoadingMsg()}});
M.DashboardItemView=M.View.extend({type:"M.DashboardItemView",icon:null,label:null,recommendedEvents:["click","tap","taphold","touchstart","touchmove","touchend","mousedown","mousemove","mouseup"],render:function(){this.html="";if(!this.icon){M.Logger.log("Please provide an icon for a dashboard item view!",M.WARN);return this.html}this.html+='<div id="'+this.id+'" class="tmp-dashboard-item" '+this.style()+">";this.html+=M.ImageView.design({value:this.icon}).render();this.html+='<div class="tmp-dashboard-item-label">'+
(this.label?this.label:this.value)+"</div>";this.html+="</div>";return this.html},registerEvents:function(){this.internalEvents={taphold:{target:this.parentView,action:"editDashboard"},tap:{target:this.parentView,action:"dispatchTapEvent"}};this.bindToCaller(this,M.View.registerEvents)()},style:function(){var a="";if(this.cssStyle)a+='style="'+this.cssStyle+'"';return a}});
M.DialogView=M.View.extend({type:"M.DialogView",isActive:NO,queue:[],showNowOrNever:NO,alert:function(a){if(this.isActive)this.enqueue("alert",a);else{this.isActive=YES;M.AlertDialogView.design(a).show()}},confirm:function(a){if(this.isActive)this.enqueue("confirm",a);else{this.isActive=YES;M.ConfirmDialogView.design(a).show()}},actionSheet:function(a){if(this.isActive)this.enqueue("actionSheet",a);else{this.isActive=YES;M.ActionSheetDialogView.design(a).show()}},enqueue:function(a,b){b.showNowOrNever||
this.queue.unshift({action:a,obj:b})},dequeue:function(){if(!this.isActive&&this.queue.length>0){var a=this.queue.pop();this[a.action](a.obj)}},show:function(){this.render();var a=$("#"+this.id),b=$(".tmp-dialog-background");b.hide();this.positionDialog(a);a.addClass("pop in");var c=this;window.setTimeout(function(){b.show();c.positionBackground(b)},1)},hide:function(){var a=$("#"+this.id),b=$(".tmp-dialog-background");a.addClass("pop out");b.remove();this.destroy();var c=this;window.setTimeout(function(){M.DialogView.isActive=
NO;c.dequeue()},100)},positionDialog:function(a){var b=M.Environment.getSize(),c=window.pageYOffset,d=window.pageXOffset,h=a.outerHeight(),i=a.outerWidth();d=d+b[0]/2;b=c+b[1]/2;a.css("position","absolute");a.css("top",b+"px");a.css("left",d+"px");a.css("z-index",1E4);a.css("margin-top","-"+h/2+"px");a.css("margin-left","-"+i/2+"px")},positionBackground:function(a){a.css("height",$(document).height()+"px");a.css("width",$(document).width()+"px")}});m_require("ui/dialog.js");
M.ActionSheetDialogView=M.DialogView.extend({type:"M.ActionSheetDialogView",title:"ActionSheet",destructiveButtonValue:null,cancelButtonValue:null,otherButtonValues:null,otherButtonTags:null,deletionDelay:1E3,callbacks:null,render:function(){this.html='<div class="tmp-dialog-background"></div>';this.html+='<div id="'+this.id+'" class="tmp-actionsheet">';this.html+='<div class="tmp-dialog-header">';this.html+=this.title?this.title:"";this.html+="</div>";this.html+='<div class="tmp-dialog-footer">';
var a=this,b=[];this.destructiveButtonValue&&b.push(M.ButtonView.design({value:this.destructiveButtonValue,tag:"destruction",dataTheme:"a tmp-actionsheet-destructive-button",events:{tap:{target:a,action:"handleCallback"}}}));if(this.otherButtonValues){if(this.otherButtonTags&&!_.isArray(this.otherButtonTags)&&!_.isArray(this.otherButtonValues)){M.Logger.log("Error in Action Sheet: Values and (optional) tags must be passed as string in an array! Rendering will not proceed.",M.WARN);return""}if(this.otherButtonTags&&
this.otherButtonTags.length!==this.otherButtonValues.length){M.Logger.log("Mismatch in Action Sheet: Number of other button's tags doesn't match number of values. Will not use given values, but use generated numbers as values.",M.WARN);this.otherButtonTags=null}var c=0;_.each(this.otherButtonValues,function(h){b.push(M.ButtonView.design({value:h,tag:a.otherButtonTags?a.otherButtonTags[c++]:c++,events:{tap:{target:a,action:"handleCallback"}}}))})}this.cancelButtonValue&&b.push(M.ButtonView.design({value:this.cancelButtonValue,
tag:"cancel",dataTheme:"a",events:{tap:{target:a,action:"handleCallback"}}}));for(var d in b)this.html+=b[d].render();this.html+="</div>";this.html+="</div>";$("body").append(this.html);for(d in b){b[d].registerEvents();b[d].theme()}},show:function(){this.render();var a=$("#"+this.id),b=$(".tmp-dialog-background");b.hide();a.removeClass("slideup out reverse");a.addClass("slideup in");var c=this;window.setTimeout(function(){b.show();c.positionBackground(b);$(".tmp-dialog-background").bind("click tap",
function(){c.hide()})},1)},handleCallback:function(a){this.hide();a=M.ViewManager.getViewById(a);var b=a.tag==="destruction"||a.tag==="cancel"?a.tag:"other";this.callbacks&&b&&M.EventDispatcher.checkHandler(this.callbacks[b])&&this.bindToCaller(this.callbacks[b].target,this.callbacks[b].action,a.tag)()}});m_require("ui/dialog.js");
M.AlertDialogView=M.DialogView.extend({type:"M.AlertDialogView",title:"Alert",message:"",hasConfirmButton:YES,confirmButtonValue:"Ok",callbacks:null,render:function(){this.html='<div class="tmp-dialog-background"></div>';this.html+='<div id="'+this.id+'" class="tmp-dialog">';this.html+='<div class="tmp-dialog-header">';this.html+=this.title?this.title:"";this.html+="</div>";this.html+='<div class="tmp-dialog-content">';this.html+=this.message;this.html+="</div>";var a;if(this.hasConfirmButton){this.html+=
'<div class="tmp-dialog-footer">';a=M.ButtonView.design({value:this.confirmButtonValue,dataTheme:"b tmp-dialog-smallerbtn",events:{tap:{target:this,action:"handleCallback"}}});this.html+=a.render();this.html+="</div>"}this.html+="</div>";$("body").append(this.html);if(a.type){a.registerEvents();a.theme()}},handleCallback:function(){this.hide();this.callbacks&&M.EventDispatcher.checkHandler(this.callbacks.confirm)&&this.bindToCaller(this.callbacks.confirm.target,this.callbacks.confirm.action)()}});
m_require("ui/dialog.js");
M.ConfirmDialogView=M.DialogView.extend({type:"M.ConfirmDialogView",title:"Confirm",message:"",confirmButtonValue:"Ok",cancelButtonValue:"Cancel",callbacks:null,render:function(){this.html='<div class="tmp-dialog-background"></div>';this.html+='<div id="'+this.id+'" class="tmp-dialog">';this.html+='<div class="tmp-dialog-header">';this.html+=this.title?this.title:"";this.html+="</div>";this.html+='<div class="tmp-dialog-content">';this.html+=this.message;this.html+="</div>";this.html+='<div class="tmp-dialog-footer">';
var a=M.ButtonView.design({value:this.confirmButtonValue,dataTheme:"b tmp-dialog-smallerbtn-confirm",events:{tap:{target:this,action:"confirmed"}}}),b=M.ButtonView.design({value:this.cancelButtonValue,dataTheme:"d tmp-dialog-smallerbtn-confirm",events:{tap:{target:this,action:"canceled"}}});this.html+=M.GridView.design({childViews:"confirm cancel",layout:M.TWO_COLUMNS,confirm:a,cancel:b}).render();this.html+="</div>";this.html+="</div>";$("body").append(this.html);if(a.type){a.registerEvents();a.theme()}if(b.type){b.registerEvents();
b.theme()}},confirmed:function(){this.hide();this.callbacks&&M.EventDispatcher.checkHandler(this.callbacks.confirm)&&this.bindToCaller(this.callbacks.confirm.target,this.callbacks.confirm.action)()},canceled:function(){this.hide();this.callbacks&&M.EventDispatcher.checkHandler(this.callbacks.cancel)&&this.bindToCaller(this.callbacks.cancel.target,this.callbacks.cancel.action)()}});
M.SelectionListItemView=M.View.extend({type:"M.SelectionListItemView",label:null,isSelected:NO,render:function(){this.html="";if(this.parentView&&(this.parentView.selectionMode===M.SINGLE_SELECTION_DIALOG||this.parentView.selectionMode===M.MULTIPLE_SELECTION_DIALOG)){this.html+='<option id="'+this.id+'" value="'+this.value+'"';if(this.isSelected&&typeof this.isSelected==="boolean"||this.isSelected===String(YES))if(!this.parentView.selection){this.html+=' selected="selected"';this.parentView.selection=
this}this.html+=">";this.html+=this.label?this.label:this.value;this.html+="</option>"}else{this.html+='<input type="'+this.parentView.selectionMode+'" data-native-menu="false" id="'+this.id+'"';if(this.parentView.selectionMode===M.SINGLE_SELECTION)this.html+=' name="'+(this.parentView.name?this.parentView.name:this.parentView.id)+'"';else if(this.parentView.selectionMode===M.MULTIPLE_SELECTION)this.html+=' name="'+(this.name?this.name:this.id)+'"';if(this.isSelected&&typeof this.isSelected==="boolean"||
this.isSelected===String(YES))if(this.parentView.selectionMode===M.SINGLE_SELECTION){if(!this.parentView.selection){this.html+=' checked="checked"';this.parentView.selection=this}}else{this.html+=' checked="checked"';if(!this.parentView.selection)this.parentView.selection=[];this.parentView.selection.push(this)}this.html+="/>";this.html+='<label for="'+this.id+'">'+(this.label?this.label:this.value)+"</label>"}return this.html},theme:function(){this.parentView&&this.parentView.selectionMode!==M.SINGLE_SELECTION_DIALOG&&
this.parentView.selectionMode!==M.MULTIPLE_SELECTION_DIALOG&&$("#"+this.id).checkboxradio()}});M.SINGLE_SELECTION="radio";M.MULTIPLE_SELECTION="checkbox";M.SINGLE_SELECTION_DIALOG="select";M.MULTIPLE_SELECTION_DIALOG="select_multiple";m_require("ui/selection_list_item.js");
M.SelectionListView=M.View.extend({type:"M.SelectionListView",removeItemsOnUpdate:YES,selectionMode:M.SINGLE_SELECTION,selection:null,name:null,initialText:null,label:null,isGrouped:NO,initialState:null,recommendedEvents:["change"],hasAsteriskOnLabel:NO,cssClassForAsterisk:null,render:function(){this.initialState=[];this.html='<div id="'+this.id+'_container"';if(this.isGrouped)this.html+=' data-role="fieldcontain"';if(this.cssClass){this.html+=' class="';var a=$.trim(this.cssClass).split(" "),b;for(b in a)this.html+=
(b>0?" ":"")+a[b]+"_container";this.html+='"'}this.html+=">";if(this.selectionMode===M.SINGLE_SELECTION_DIALOG||this.selectionMode===M.MULTIPLE_SELECTION_DIALOG){if(this.label){this.html+='<label for="'+this.id+'">'+this.label;this.html+=this.hasAsteriskOnLabel?this.cssClassForAsterisk?'<span class="'+this.cssClassForAsterisk+'">*</span></label>':"<span>*</span></label>":"</label>"}this.html+='<select name="'+(this.name?this.name:this.id)+'" id="'+this.id+'"'+this.style()+(this.selectionMode===M.MULTIPLE_SELECTION_DIALOG?
' multiple="multiple"':"")+">";this.renderChildViews();this.html+="</select>"}else{this.html+='<fieldset data-role="controlgroup" data-native-menu="false" id="'+this.id+'">';if(this.label){this.html+="<legend>"+this.label;this.html+=this.hasAsteriskOnLabel?this.cssClassForAsterisk?'<span class="'+this.cssClassForAsterisk+'">*</span></legend>':"<span>*</span></legend>":"</legend>"}this.renderChildViews();this.html+="</fieldset>"}this.html+="</div>";return this.html},renderChildViews:function(){if(this.childViews){var a=
this.getChildViewsAsArray(),b;for(b in a){var c=this[a[b]];if(c.type==="M.SelectionListItemView"){c.parentView=this;c._name=a[b];this.html+=c.render();this.initialState.push({value:c.value,label:c.label,isSelected:c.isSelected})}else M.Logger.log("Invalid child views specified for SelectionListView. Only SelectionListItemViews accepted.",M.WARN)}}else this.contentBinding||M.Logger.log("No SelectionListItemViews specified.",M.WARN)},registerEvents:function(){this.internalEvents={change:{target:this,
action:"itemSelected"}};this.bindToCaller(this,M.View.registerEvents)()},addItem:function(a){$("#"+this.id).append(a)},removeAllItems:function(){$("#"+this.id).empty()},renderUpdate:function(){if(this.removeItemsOnUpdate||this.selectionMode===M.SINGLE_SELECTION_DIALOG||this.selectionMode===M.MULTIPLE_SELECTION_DIALOG){this.removeAllItems();if(this.label&&!(this.selectionMode===M.SINGLE_SELECTION_DIALOG||this.selectionMode===M.MULTIPLE_SELECTION_DIALOG))this.addItem("<legend>"+this.label+"</legend>")}this.removeSelection();
if(this.contentBinding){var a=this.value,b;for(b in a){var c=a[b],d=null;d=M.SelectionListItemView.design({value:c.value!==undefined&&c.value!==null?c.value:"",label:c.label?c.label:c.value!==undefined&&c.value!==null?c.value:"",parentView:this,isSelected:c.isSelected});if(this.selectionMode!==M.SINGLE_SELECTION_DIALOG&&this.selectionMode!==M.MULTIPLE_SELECTION_DIALOG)d.name=c.name?c.name:c.label?c.label:c.value?c.value:"";this.addItem(d.render());d.theme()}this.themeUpdate()}},theme:function(){if(this.selectionMode===
M.SINGLE_SELECTION_DIALOG||this.selectionMode===M.MULTIPLE_SELECTION_DIALOG){$("#"+this.id).selectmenu();if(this.selectionMode===M.MULTIPLE_SELECTION_DIALOG&&this.initialText&&this.selection&&this.selection.length===0||this.selectionMode===M.SINGLE_SELECTION_DIALOG&&!this.selection&&this.initialText){$("#"+this.id+"_container").find(".ui-btn-text").html(this.initialText);document.getElementById(this.id).selectedIndex=-1}}else this.selectionMode!==M.SINGLE_SELECTION_DIALOG&&this.selectionMode!==M.MULTIPLE_SELECTION_DIALOG&&
$("#"+this.id).controlgroup()},themeUpdate:function(){if(this.selectionMode===M.SINGLE_SELECTION_DIALOG||this.selectionMode===M.MULTIPLE_SELECTION_DIALOG){$("#"+this.id).selectmenu("refresh");if(this.selectionMode===M.MULTIPLE_SELECTION_DIALOG&&this.initialText&&this.selection&&this.selection.length===0||this.selectionMode===M.SINGLE_SELECTION_DIALOG&&!this.selection&&this.initialText){$("#"+this.id+"_container").find(".ui-btn-text").html(this.initialText);document.getElementById(this.id).selectedIndex=
-1}else if(this.selectionMode===M.SINGLE_SELECTION_DIALOG&&!this.selection){var a=M.ViewManager.getViewById($("#"+this.id).find("option:first-child").attr("id"));a!==undefined&&a!==null&&this.setSelection(a.value)}}else this.selectionMode!==M.SINGLE_SELECTION_DIALOG&&this.selectionMode!==M.MULTIPLE_SELECTION_DIALOG&&$("#"+this.id).controlgroup()},style:function(){var a="";if(this.cssClass)a+=' class="'+this.cssClass+'"';return a},itemSelected:function(a,b,c){a=null;if(this.selectionMode===M.SINGLE_SELECTION){a=
M.ViewManager.getViewById($("input[name="+(this.name?this.name:this.id)+"]:checked").attr("id"));if(a!==this.selection){this.selection=a;c&&M.EventDispatcher.callHandler(c,b,NO,[this.selection.value,this.selection])}}else if(this.selectionMode===M.SINGLE_SELECTION_DIALOG){a=M.ViewManager.getViewById($("#"+this.id+" :selected").attr("id"));if(a!==this.selection){this.selection=a;$("#"+this.id+"_container").find(".ui-btn-text").html(a.label?a.label:a.value);c&&M.EventDispatcher.callHandler(c,b,NO,[this.selection.value,
this.selection])}}else if(this.selectionMode===M.MULTIPLE_SELECTION){var d=this;this.selection=[];$("#"+this.id).find("input:checked").each(function(){d.selection.push(M.ViewManager.getViewById($(this).attr("id")))});a=[];for(var h in this.selection)a.push(this.selection[h].value);c&&M.EventDispatcher.callHandler(c,b,NO,[a,this.selection])}else if(this.selectionMode===M.MULTIPLE_SELECTION_DIALOG){d=this;this.selection=[];$("#"+this.id).find(":selected").each(function(){d.selection.push(M.ViewManager.getViewById($(this).attr("id")))});
a=[];for(h in this.selection){a.push(this.selection[h].value);$("#"+this.id+"_container").find(".ui-btn-text").html(this.formatSelectionLabel(this.selection.length))}$("#"+this.id+"_container").find(".ui-li-count").html(this.selection?this.selection.length:0);this.selection.length===0&&this.themeUpdate();c&&M.EventDispatcher.callHandler(c,b,NO,[a,this.selection])}this.selectionMode!==M.MULTIPLE_SELECTION_DIALOG&&$("#"+this.id).blur();this.delegateValueUpdate()},delegateValueUpdate:function(){this.contentBindingReverse&&
this.contentBindingReverse.target.set(this.contentBindingReverse.property,this.selection.value)},getSelection:function(a){if(this.selectionMode===M.SINGLE_SELECTION||this.selectionMode===M.SINGLE_SELECTION_DIALOG){if(this.selection)return a?this.selection:this.selection.value}else{if(this.selection){var b=[];_.each(this.selection,function(c){a?b.push(c):b.push(c.value)});return b}return[]}},setSelection:function(a){var b=this;if(this.selectionMode===M.SINGLE_SELECTION&&(typeof a==="string"||typeof a===
"number"||typeof a==="boolean"))$("#"+this.id).find("input").each(function(){var h=M.ViewManager.getViewById($(this).attr("id"));if(h.value==a){b.removeSelection();h.isSelected=YES;b.selection=h;$(this).attr("checked","checked");$(this).siblings("label:first").addClass("ui-radio-on");$(this).siblings("label:first").removeClass("ui-radio-off");$(this).siblings("label:first").find("span .ui-icon-radio-off").addClass("ui-icon-radio-on");$(this).siblings("label:first").find("span .ui-icon-radio-off").removeClass("ui-icon-radio-off")}});
else if(this.selectionMode===M.SINGLE_SELECTION_DIALOG&&(typeof a==="string"||typeof a==="number"||typeof a==="boolean")){var c=NO;$("#"+this.id).find("option").each(function(){var h=M.ViewManager.getViewById($(this).attr("id"));if(h.value==a){b.removeSelection();h.isSelected=YES;b.selection=h;$("#"+b.id).val(h.value);c=YES}});c&&$("#"+this.id).selectmenu("refresh")}else if(typeof a==="object")if(this.selectionMode===M.MULTIPLE_SELECTION){var d=NO;$("#"+this.id).find("input").each(function(){var h=
M.ViewManager.getViewById($(this).attr("id")),i;for(i in a)if(h.value==a[i]){if(!d){b.removeSelection();d=YES}h.isSelected=YES;b.selection.push(h);$(this).attr("checked","checked");$(this).siblings("label:first").removeClass("ui-checkbox-off");$(this).siblings("label:first").addClass("ui-checkbox-on");$(this).siblings("label:first").find("span .ui-icon-checkbox-off").addClass("ui-icon-checkbox-on");$(this).siblings("label:first").find("span .ui-icon-checkbox-off").removeClass("ui-icon-checkbox-off")}})}else if(this.selectionMode===
M.MULTIPLE_SELECTION_DIALOG){d=NO;$("#"+this.id).find("option").each(function(){var h=M.ViewManager.getViewById($(this).attr("id")),i;for(i in a)if(h.value==a[i]){if(!d){b.removeSelection();d=YES}h.isSelected=YES;b.selection.push(h);$(this).attr("selected","selected")}$("#"+b.id+"_container").find(".ui-btn-text").html(b.formatSelectionLabel(b.selection.length));$("#"+b.id+"_container").find(".ui-li-count").html(b.selection?b.selection.length:0)})}},removeSelection:function(){var a=this;this.selection=
this.selectionMode===M.SINGLE_SELECTION||this.selectionMode===M.SINGLE_SELECTION_DIALOG?null:[];if(this.selectionMode!==M.SINGLE_SELECTION_DIALOG&&this.selectionMode!==M.MULTIPLE_SELECTION_DIALOG)$("#"+this.id).find("input").each(function(){M.ViewManager.getViewById($(this).attr("id")).isSelected=NO;$(this).removeAttr("checked");$(this).siblings("label:first").addClass("ui-"+a.selectionMode+"-off");$(this).siblings("label:first").removeClass("ui-"+a.selectionMode+"-on");$(this).siblings("label:first").find("span .ui-icon-"+
a.selectionMode+"-on").addClass("ui-icon-"+a.selectionMode+"-off");$(this).siblings("label:first").find("span .ui-icon-"+a.selectionMode+"-on").removeClass("ui-icon-"+a.selectionMode+"-on")});else{$("#"+this.id).find("option").each(function(){M.ViewManager.getViewById($(this).attr("id")).isSelected=NO});$("#"+this.id).val("").removeAttr("checked").removeAttr("selected")}},resetSelection:function(){if(this.contentBinding){this.removeSelection();this.renderUpdate()}else{this.contentBinding={};this.contentBinding.target=
this;this.contentBinding.property="initialState";this.removeSelection();this.renderUpdate();this.contentBinding=null}},clearValue:function(){this.resetSelection()},getValue:function(){return this.getSelection()},formatSelectionLabel:function(a){return a+" Object(s)"},disable:function(){this.isEnabled=NO;if(this.selectionMode===M.SINGLE_SELECTION||this.selectionMode===M.MULTIPLE_SELECTION)$("#"+this.id).find("input").each(function(){$(this).checkboxradio("disable")});else{$("#"+this.id).selectmenu("disable");
$("#"+this.id).each(function(){$(this).attr("disabled","disabled")})}},enable:function(){this.isEnabled=YES;if(this.selectionMode===M.SINGLE_SELECTION||this.selectionMode===M.MULTIPLE_SELECTION)$("#"+this.id).find("input").each(function(){$(this).checkboxradio("enable")});else{$("#"+this.id).selectmenu("enable");$("#"+this.id).each(function(){$(this).removeAttr("disabled")})}},valueDidChange:function(){var a=this.valueBinding?this.valueBinding:this.computedValue?this.computedValue.valueBinding:null;
if(a){var b=a.target,c=a.property.split(".");_.each(c,function(d){if(b)b=b[d]});!b||b===undefined||b===null?M.Logger.log("The value assigned by valueBinding (property: '"+a.property+"') for "+this.type+" ("+(this._name?this._name+", ":"")+"#"+this.id+") is invalid!",M.WARN):this.setSelection(b)}}});M.HYPERLINK_EMAIL="mail";M.HYPERLINK_WEBSITE="website";M.HYPERLINK_PHONE="phone";
M.LabelView=M.View.extend({type:"M.LabelView",newLineToBreak:YES,tabToSpaces:YES,hyperlinkType:null,hyperlinkTarget:null,recommendedEvents:["tap"],render:function(){this.computeValue();this.html+='<div id="'+this.id+'"'+this.style()+">";if(this.hyperlinkTarget&&this.hyperlinkType)switch(this.hyperlinkType){case M.HYPERLINK_EMAIL:this.html+='<a rel="external" href="mailto:'+this.hyperlinkTarget+'">';break;case M.HYPERLINK_WEBSITE:this.html+='<a rel="external" target="_blank" href="'+this.hyperlinkTarget+
'">';break;case M.HYPERLINK_PHONE:this.html+='<a rel="external" href="tel:'+this.hyperlinkTarget+'">'}this.html+=this.newLineToBreak?this.nl2br(this.tabToSpaces?this.tab2space(this.value):this.value):this.tabToSpaces?this.tab2space(this.value):this.value;if(this.hyperlinkTarget&&this.hyperlinkType)this.html+="</a>";this.html+="</div>";return this.html},renderUpdate:function(){this.computeValue();$("#"+this.id).html(this.newLineToBreak?this.nl2br(this.value):this.value)},style:function(){var a="";
if(this.isInline)a+=' style="display:inline;"';if(this.cssClass)a+=' class="'+this.cssClass+'"';return a},setValue:function(a){this.value=a;this.renderUpdate()}});
M.ToggleSwitchView=M.View.extend({type:"M.ToggleSwitchView",isMini:NO,onLabel:"",offLabel:"",onValue:YES,offValue:NO,fieldcontain:NO,recommendedEvents:["change"],render:function(){this.html="";if(!this.onLabel)this.onLabel=this.onValue;if(!this.offLabel)this.offLabel=this.offValue;var a="";if(this.fieldcontain)a=' data-role="fieldcontain" ';var b="";if(this.isInline)b=' style="display: inline-block" ';if(this.label)this.html+="<label"+b+' for="'+this.id+'">'+this.label+"</label>";this.html+="<div"+
a+b+' id="'+this.id+'_container" '+this.style()+">";this.html+='<select name="'+this.id+'" id="'+this.id+'" data-role="slider" data-mini="'+this.isMini+'">';this.html+='<option value="'+this.offValue+'">'+this.offLabel+"</option>";this.html+='<option value="'+this.onValue+'">'+this.onLabel+"</option>";this.html+="</select>";this.html+="</div>";return this.html},theme:function(){},style:function(){var a=' class="';if(this.cssClass)a+=this.cssClass;a+='" ';return a},getValue:function(){return $("#"+
this.id).val()},setValue:function(a){var b=true;$("#"+this.id+" option").each(function(){if($(this).html()===a){$(this).attr("selected","selected");b=false}});b&&$("#"+this.id+" option[value*="+a+"]").attr("selected","selected");$("#"+this.id).slider("refresh")},on:function(){this.setValue(this.onValue)},off:function(){this.setValue(this.offValue)},enable:function(){$("#"+this.id).slider("enable")},disable:function(){$("#"+this.id).slider("disable")}});
M.ContainerView=M.View.extend({type:"M.ContainerView",render:function(){this.html='<div id="'+this.id+'"'+this.style()+">";this.renderChildViews();this.html+="</div>";return this.html},style:function(){var a="";if(this.cssClass)a+=' class="'+this.cssClass+'"';return a}});
M.PopoverView=M.View.extend({type:"M.PopoverView",menu:null,scrollview:null,hasPopScrollview:NO,selectedItemInPopover:null,render:function(){this.html='<div data-role="page" id="'+this.id+'" class="tmp-popover">';this.html+=M.ToolbarView.design({value:"Menu",cssClass:"tmp-popover-header"}).render();this.menu=M.ListView.design({});this.scrollview=M.ScrollView.design({cssClass:"tmp-popover-content",childViews:"list",list:this.menu});this.html+=this.scrollview.render();this.html+='<div class="tmp-popover-arrow"></div>';
this.html+="</div>";$("body").append(this.html);this.selectedItemInPopover=null;for(var a in this.items){var b=M.ListItemView.design({childViews:"label",parentView:this.splitview.menu.menu,splitViewItem:this.items[a],label:M.LabelView.design({value:this.items[a].value}),events:{tap:{target:this,action:"itemSelected"}}});this.scrollview.list.addItem(b.render());if(b.splitViewItem.id===this.splitview.selectedItem.id)this.selectedItemInPopover=b.id;b.registerEvents()}this.splitview.menu.menu.setActiveListItem(this.selectedItemInPopover);
this.splitview.listItemSelected(this.selectedItemInPopover)},renderUpdate:function(){var a,b=this;$("#"+this.menu.id).find("li").each(function(){if(M.ViewManager.getViewById($(this).attr("id")).splitViewItem.id===b.splitview.selectedItem.id)a=$(this).attr("id")});if(a){this.menu.setActiveListItem(a);this.selectedItemInPopover=a}},show:function(){this.render();this.theme();this.toggle()},hide:function(){$("#"+this.id).hide()},theme:function(){$("#"+this.id).page();this.themeChildViews();var a=M.Environment.getSize()[0];
$("#"+this.id).css("width",Math.floor(a*0.4)+"px")},resizePopup:function(){var a=$("#"+this.menu.id).find("li:first").outerHeight(),b=$("#"+this.menu.id).find("li").length,c=M.Environment.getHeight()*0.7;a=b*a;if(c<a){$("#"+this.menu.id).css("height",c);$("#"+this.menu.id).scrollview({direction:"y"});this.hasPopScrollview=YES}else $("#"+this.menu.id).css("height",a);this.hasPopScrollview&&this.scrollListToRightPosition()},toggle:function(){$("#"+this.id).toggle();this.resizePopup()},itemSelected:function(a){this.toggle();
this.splitview.listItemSelected(a)},scrollListToRightPosition:function(){var a=$("#"+this.menu.id+" li:first-child").outerHeight(),b=($("#"+this.selectedItemInPopover).index()+1)*a,c=M.Environment.getHeight()*0.7,d=$("#"+this.menu.id).find("li").length*a;a=c/2;d=d-b;var h=0;if(b>c)h=d<a?-(b-c+d):-(b-a);else if(b<c)h=b<a?0:-(b-a);$("#"+this.menu.id).scrollview("scrollTo",0,h)}});
M.SplitItemView=M.View.extend({type:"M.SplitItemView",render:function(){this.html='<div id="'+this.id+'">';this.renderChildViews();this.html+="</div>";return this.html},renderUpdate:function(){},theme:function(){}});
M.WebView=M.View.extend({type:"M.WebView",isScrollable:YES,recommendedEvents:["load"],render:function(){this.computeValue();this.checkURL();return this.html='<div id="'+this.id+'"></div>'},theme:function(){this.renderUpdate()},renderUpdate:function(){if(this.value){this.computeValue();this.checkURL()}if(this.value&&this.html&&this.html.indexOf("<div")===0){this.html='<iframe id="'+this.id+'"'+this.style()+' src="'+this.value+'" scrolling="'+(this.isScrollable?"YES":"NO")+'"></iframe>';$("#"+this.id).replaceWith(this.html);
this.registerEvents()}else this.value&&this.html&&this.html.indexOf("<iframe")===0&&$("#"+this.id).attr("src",this.value)},checkURL:function(){if(this.value&&this.value.lastIndexOf("http://")<0&&this.value.lastIndexOf("https://")<0)this.value="http://"+this.value},style:function(){var a=' class="tmp-webview';if(this.cssClass)a+=" "+this.cssClass;a+='"';return a},reload:function(){$("#"+this.id).attr("src",this.value)}});
M.FormView=M.View.extend({type:"M.FormView",showAlertDialogOnError:YES,alertTitle:"Validation Error(s)",validate:function(){var a=this.getIds(),b;for(b in a)M.ViewManager.getViewById(a[b]).validators||delete a[b];var c=YES;M.Validator.clearErrorBuffer();for(b in a){var d=M.ViewManager.getViewById(a[b]);if(d&&d.validators){d.cssClassOnError&&d.removeCssClass(d.cssClassOnError);_.each(d.validators,function(h){h.validate(d,b)||(c=NO)})}}c||this.showErrors();return c},showErrors:function(){var a="";_.each(M.Validator.validationErrors,
function(b){if(b&&b.errObj){var c=M.ViewManager.getViewById(b.errObj.viewId);c&&c.cssClassOnError&&c.addCssClass(c.cssClassOnError);a+="<li>"+b.msg+"</li>"}});this.showAlertDialogOnError&&M.DialogView.alert({title:this.alertTitle,message:a})},clearForm:function(){this.clearValues()},getFormValues:function(){return this.getValues()}});M.MAP_MARKER_ANIMATION_NONE="NONE";M.MAP_MARKER_ANIMATION_DROP="DROP";M.MAP_MARKER_ANIMATION_BOUNCE="BOUNCE";
M.MapMarkerView=M.View.extend({type:"M.MapMarkerView",marker:null,data:null,map:null,title:null,message:null,showAnnotationOnClick:NO,annotation:null,isDraggable:NO,location:M.Location.extend({latitude:48.813338,longitude:9.178463}),markerAnimationType:null,icon:null,iconSize:null,isIconCentered:NO,recommendedEvents:["click","tap"],init:function(a){a=this.extend(a);if(a.annotation||a.message){var b=a.title?'<h1 class="ui-annotation-header">'+a.title+"</h1>":"";b+=a.message?'<p class="ui-annotation-message">'+
a.message+"</p>":"";a.annotation=new google.maps.InfoWindow({content:b,maxWidth:100})}return a},registerEvents:function(){this.internalEvents={tap:{target:this,action:"showAnnotation"}};var a=this;google.maps.event.addListener(this.marker,"click",function(){M.EventDispatcher.callHandler(a.internalEvents.tap,event,YES)})},remove:function(){this.map.removeMarker(this)},showAnnotation:function(a,b){this.annotation&&this.annotation.open(this.map.map,this.marker);if(this.events||this.map.events){var c=
this.events?this.events:this.map.events,d;for(d in c)if(d===(b.type==="click"||b.type==="touchend"?"tap":b.type))M.EventDispatcher.callHandler(c[d],b,NO,[this])}}});
M.TabBarView=M.View.extend({type:"M.TabBarView",anchorLocation:null,name:"tab_bar",activeTab:null,usageCounter:0,toggleOnTap:NO,render:function(){this.html="";this.usageCounter+=1;this.html+=this.anchorLocation?'<div id="'+this.id+'" data-id="'+this.name+'" data-role="'+this.anchorLocation+'" data-position="fixed" data-tap-toggle="'+this.toggleOnTap+'" data-transition="'+(M.Application.getConfig("useTransitions")?M.TRANSITION.SLIDE:M.TRANSITION.NONE)+'"><div data-role="navbar"><ul>':'<div data-role="navbar" id="'+
this.id+'" data-id="'+this.name+'"><ul>';this.renderChildViews();this.html+="</ul></div>";if(this.anchorLocation)this.html+="</div>";return this.html},renderChildViews:function(){if(this.childViews){var a=this.getChildViewsAsArray(),b=NO,c;for(c in a){var d=this[a[c]];if(d.type==="M.TabBarItemView"&&d.isActive)if(b)d.isActive=NO;else{b=YES;this.activeTab=d}}var h=0;for(c in a){d=this[a[c]];if(d.type==="M.TabBarItemView"){h+=1;if(h===1&&!b){d.isActive=YES;this.activeTab=d}d.parentView=this;d._name=
a[c];this.html+=d.render()}else M.Logger.log("Invalid child views specified for TabBarView. Only TabBarItemViews accepted.",M.WARN)}}else M.Logger.log("No TabBarItemViews specified.",M.WARN)},setActiveTab:function(a){this.activeTab.isActive=NO;var b=this.activeTab.id.substring(0,this.activeTab.id.lastIndexOf("_"));$("[id^="+b+"_]").each(function(){$(this).removeClass("ui-btn-active")});a.isActive=YES;this.activeTab=a;a=a.id.substring(0,a.id.lastIndexOf("_"));$("[id^="+a+"_]").each(function(){$(this).addClass("ui-btn-active")})}});
M.MAP_ROADMAP="ROADMAP";M.MAP_HYBRID="HYBRID";M.MAP_SATELLITE="SATELLITE";M.MAP_TERRAIN="TERRAIN";M.INITIAL_MAP=null;
M.MapView=M.View.extend({type:"M.MapView",map:null,markers:null,isInset:YES,zoomLevel:15,mapType:M.MAP_ROADMAP,showMapTypeControl:NO,showNavigationControl:NO,showStreetViewControl:NO,isDraggable:YES,initialLocation:M.Location.extend({latitude:48.813338,longitude:9.178463}),setMarkerAtInitialLocation:NO,markerAnimationType:M.MAP_MARKER_ANIMATION_NONE,isInitialized:NO,removeMarkersOnUpdate:YES,callbacks:null,loadPlacesLibrary:YES,recommendedEvents:["click","tap"],render:function(){this.html='<div data-fullscreen="true" id="'+
this.id+'"';this.html+=!this.isInset?' class="ui-listview"':"";this.html+='><div id="'+this.id+'_map"'+this.style()+"></div></div>";return this.html},renderUpdate:function(){var a=null;if(this.contentBinding&&this.contentBinding.target&&typeof this.contentBinding.target==="object"&&this.contentBinding.property&&typeof this.contentBinding.property==="string"&&this.contentBinding.target[this.contentBinding.property]){a=this.contentBinding.target[this.contentBinding.property];var b=[],c=this;if(a&&a[0]&&
a[0].type==="M.Location")_.each(a,function(d){d&&typeof d==="object"&&d.type==="M.Location"&&b.push(M.MapMarkerView.init({location:d,map:c}))});else if(a&&a[0]&&a[0].type==="M.MapMarkerView")b=_.select(a,function(d){return d&&d.type==="M.MapMarkerView"});this.removeMarkersOnUpdate&&this.removeAllMarkers();_.each(b,function(d){c.addMarker(d)})}else M.Logger.log("No valid content binding specified for M.MapView ("+this.id+")!",M.WARN)},registerEvents:function(){},style:function(){var a="";if(this.cssClass)a+=
' class="'+this.cssClass+'"';return a},initMap:function(a,b){if(!this.isInitialized||b){if(!b)this.markers=[];if(typeof google==="undefined"){M.INITIAL_MAP={map:this,options:a,isUpdate:b};M.Environment.getConnectionStatus({target:this,action:"didRetrieveConnectionStatus"})}else this.googleDidLoad(a,b,true)}else M.Logger.log("The M.MapView has already been initialized",M.WARN)},didRetrieveConnectionStatus:function(a){if(a===M.ONLINE)$.getScript("http://maps.google.com/maps/api/js?"+(this.loadPlacesLibrary?
"libraries=places&":"")+"sensor=true&callback=M.INITIAL_MAP.map.googleDidLoad");else(a=M.INITIAL_MAP.options?M.INITIAL_MAP.options.callbacks:null)&&M.EventDispatcher.checkHandler(a.error)&&this.bindToCaller(a.error.target,a.error.action)()},googleDidLoad:function(a,b,c){if(!c){a=M.INITIAL_MAP.options;b=M.INITIAL_MAP.isUpdate}for(var d in a)switch(d){case "zoomLevel":this[d]=typeof a[d]==="number"&&a[d]>0?a[d]>22?22:a[d]:this[d];break;case "mapType":this[d]=a[d]===M.MAP_ROADMAP||a[d]===M.MAP_HYBRID||
a[d]===M.MAP_SATELLITE||a[d]===M.MAP_TERRAIN?a[d]:this[d];break;case "markerAnimationType":this[d]=a[d]===M.MAP_MARKER_ANIMATION_BOUNCE||a[d]===M.MAP_MARKER_ANIMATION_DROP?a[d]:this[d];break;case "showMapTypeControl":case "showNavigationControl":case "showStreetViewControl":case "isDraggable":case "setMarkerAtInitialLocation":case "removeMarkersOnUpdate":this[d]=typeof a[d]==="boolean"?a[d]:this[d];break;case "initialLocation":this[d]=typeof a[d]==="object"&&a[d].type==="M.Location"?a[d]:this[d];
break;case "callbacks":this[d]=typeof a[d]==="object"?a[d]:this[d]}if(b){this.removeMarkersOnUpdate&&this.removeAllMarkers();this.map.setOptions({zoom:this.zoomLevel,center:new google.maps.LatLng(this.initialLocation.latitude,this.initialLocation.longitude),mapTypeId:google.maps.MapTypeId[this.mapType],mapTypeControl:this.showMapTypeControl,navigationControl:this.showNavigationControl,streetViewControl:this.showStreetViewControl,draggable:this.isDraggable})}else this.map=new google.maps.Map($("#"+
this.id+"_map")[0],{zoom:this.zoomLevel,center:new google.maps.LatLng(this.initialLocation.latitude,this.initialLocation.longitude),mapTypeId:google.maps.MapTypeId[this.mapType],mapTypeControl:this.showMapTypeControl,navigationControl:this.showNavigationControl,streetViewControl:this.showStreetViewControl,draggable:this.isDraggable});this.setMarkerAtInitialLocation&&this.addMarker(M.MapMarkerView.init({location:this.initialLocation,map:this.map}));this.isInitialized=YES;!b&&this.callbacks.success&&
M.EventDispatcher.checkHandler(this.callbacks.success)&&this.bindToCaller(this.callbacks.success.target,this.callbacks.success.action)()},updateMap:function(a){this.initMap(a,YES)},addMarker:function(a){if(a&&typeof a==="object"&&a.type==="M.MapMarkerView"&&typeof google!=="undefined"){a.marker=new google.maps.Marker({map:this.map,draggable:NO,animation:google.maps.Animation[a.markerAnimationType?a.markerAnimationType:this.markerAnimationType],position:new google.maps.LatLng(a.location.latitude,a.location.longitude),
icon:a.icon?new google.maps.MarkerImage(a.icon,null,null,a.iconSize&&a.isIconCentered?new google.maps.Point(a.iconSize.width/2,a.iconSize.height/2):null,a.iconSize?new google.maps.Size(a.iconSize.width,a.iconSize.height):null):a.icon});a.registerEvents();this.markers.push(a)}else M.Logger.log("No valid M.MapMarkerView passed for addMarker().",M.WARN)},removeMarker:function(a){if(a&&typeof a==="object"&&a.type==="M.MapMarkerView"){var b=NO;this.markers=_.select(this.markers,function(c){if(a===c){c.marker.setMap(null);
b=YES}return a!==c});b||M.Logger.log("No marker found matching the passed marker in removeMarker().",M.WARN)}else M.Logger.log("No valid M.MapMarkerView passed for removeMarker().",M.WARN)},removeAllMarkers:function(){_.each(this.markers,function(a){a.marker.setMap(null)});this.markers=[]}});
M.ImageView=M.View.extend({type:"M.ImageView",recommendedEvents:["click","tap","error","load"],render:function(){this.computeValue();return this.html='<img id="'+this.id+'" src="'+(this.value&&typeof this.value==="string"?this.value:"")+'"'+this.style()+" />"},registerEvents:function(){this.internalEvents={error:{target:this,action:"sourceIsInvalid"},load:{target:this,action:"sourceIsValid"}};this.bindToCaller(this,M.View.registerEvents)()},renderUpdate:function(){this.computeValue();$("#"+this.id).attr("src",
this.value)},theme:function(){},style:function(){var a="";if(this.cssClass)a+=' class="'+this.cssClass+'"';return a},sourceIsInvalid:function(a,b,c){M.Logger.log("The source '"+this.value+"' is invalid, so we hide the image!",M.WARN);$("#"+this.id).addClass("tmp-image-hidden");c&&M.EventDispatcher.callHandler(c,b,YES)},sourceIsValid:function(a,b,c){$("#"+this.id).removeClass("tmp-image-hidden");c&&M.EventDispatcher.callHandler(c,b,YES)}});
M.CarouselItemView=M.View.extend({type:"M.CarouselItemView",tag:null,render:function(){this.html='<li id="'+this.id+'" class="tmp-carousel-item">';this.renderChildViews();this.html+="</li>";return this.html}});M.OVERLAY="OVERLAY";M.REVEAL="REVEAL";M.PUSH="PUSH";
M.PanelView=M.View.extend({type:"M.PanelView",position:M.LEFT,display:M.REVEAL,dataTheme:"a",render:function(){this.html='<div id="'+this.id+'" data-role="panel" '+this.style()+">";this.renderChildViews();this.html+="</div>";return this.html},style:function(){var a="";if(this.cssClass)a+=' class="'+this.cssClass+'"';a+=this.dataTheme?' data-theme="'+this.dataTheme+'"':"";a+=' data-position="'+(this.position||M.LEFT).toLowerCase()+'"';a+=' data-display="'+(this.display||M.REVEAL).toLowerCase()+'"';
return a},open:function(){$("#"+this.id).panel("open")},close:function(){$("#"+this.id).panel("close")}});
M.SliderView=M.View.extend({type:"M.SliderView",value:0,initialValue:0,min:0,max:100,step:1,isSliderOnly:NO,highlightLeftPart:NO,recommendedEvents:["change"],label:null,hasAsteriskOnLabel:NO,cssClassForAsterisk:null,render:function(){this.html="";if(this.label){this.html+='<label for="'+this.id+'">'+this.label;this.html+=this.hasAsteriskOnLabel?this.cssClassForAsterisk?'<span class="'+this.cssClassForAsterisk+'">*</span></label>':"<span>*</span></label>":"</label>"}this.html+='<div id="'+this.id+
'_container" class="tmp-slider-container'+(this.isSliderOnly?" tmp-slider-is-slider-only":"")+'">';this.html+='<input id="'+this.id+'" type="range" data-highlight="'+this.highlightLeftPart+'" min="'+this.min+'" max="'+this.max+'" step="'+this.step+'" value="'+this.value+'"'+this.style()+">";this.html+="</div>";this.initialValue=this.value;return this.html},registerEvents:function(){if(!this.internalEvents)this.internalEvents={change:{target:this,action:"setValueFromDOM"}};this.bindToCaller(this,M.View.registerEvents)()},
renderUpdate:function(){if(isNaN(this.value))this.value=this.initialValue;else if(this.value<this.min)this.value=this.min;else if(this.value>this.max)this.value=this.max;$("#"+this.id).val(this.value);$("#"+this.id).slider("refresh")},setValueFromDOM:function(a,b,c){this.value=$("#"+this.id).val();c&&M.EventDispatcher.callHandler(c,b,NO,[this.value,this.id])},style:function(){var a="";if(this.cssClass)a+=' class="'+this.cssClass+'"';return a},theme:function(){this.isSliderOnly&&$("#"+this.id).hide();
this.isEnabled||this.disable()},resetSlider:function(){this.value=this.initialValue;this.renderUpdate()},disable:function(){this.isEnabled=NO;$("#"+this.id).slider("disable")},enable:function(){this.isEnabled=YES;$("#"+this.id).slider("enable")}});M.TOP="header";M.BOTTOM="footer";M.LEFT="LEFT";M.CENTER="CENTER";M.RIGHT="RIGHT";
M.ToolbarView=M.View.extend({type:"M.ToolbarView",anchorLocation:M.TOP,showBackButton:NO,backButton:null,isFixed:YES,isPersistent:YES,toggleOnTap:NO,render:function(){this.html='<div id="'+this.id+'" data-role="'+this.anchorLocation+'" data-tap-toggle="'+this.toggleOnTap+'"'+this.style();if(this.isFixed)this.html+=' data-position="fixed"';if(this.isPersistent)this.html+=typeof this.isPersistent==="string"?' data-id="'+this.isPersistent+'"':' data-id="themprojectpersistenttoolbar"';this.html+=' data-transition="'+
(M.Application.getConfig("useTransitions")?M.TRANSITION.SLIDE:M.TRANSITION.NONE)+'"';this.html+=">";this.renderChildViews();this.html+="</div>";return this.html},renderChildViews:function(){if(this.value&&this.showBackButton){this.backButton=M.ButtonView.design({value:"Back",icon:"arrow-l",internalEvents:{tap:{action:function(){history.back(-1)}}}});this.html+='<div class="ui-btn-left">';this.html+=this.backButton.render();this.html+="</div>";this.html+="<h1>"+this.value+"</h1>"}else if(this.value)this.html+=
"<h1>"+this.value+"</h1>";else if(this.childViews){var a=this.getChildViewsAsArray(),b={},c;for(c in a){var d=this[a[c]];d._name=a[c];if(b[d.anchorLocation]){M.Logger.log("ToolbarView has two items positioned at M."+d.anchorLocation+".  Only one item permitted in each location",M.WARN);break}b[d.anchorLocation]=YES;switch(d.anchorLocation){case M.LEFT:this.html+='<div class="ui-btn-left">';this.html+=d.render();this.html+="</div>";break;case M.CENTER:this.html+="<h1>";this.html+=d.render();this.html+=
"</h1>";break;case M.RIGHT:this.html+='<div class="ui-btn-right">';this.html+=d.render();this.html+="</div>";break;default:M.Logger.log("ToolbarView children must have an anchorLocation of M.LEFT, M.CENTER, or M.RIGHT",M.WARN);return}}}},renderUpdate:function(){this.computeValue();$("#"+this.id+" h1").text(this.value)},registerEvents:function(){this.backButton&&this.backButton.registerEvents();this.bindToCaller(this,M.View.registerEvents)()},style:function(){var a="";if(this.cssClass)a+=' class="'+
this.cssClass+'"';return a}});
M.MovableLabelView=M.LabelView.extend({type:"M.MovableLabelView",movable:null,extraStyle:null,moveRulesAvailable:NO,$this:null,$parent:null,render:function(){var a=this,b;this.computeValue();if(_.isObject(this.movable))if(this.movable.time||this.movable.time===0||this.movable.pxPerSec||this.movable.pxPerSec===0){this.html='<div class="tmp-movable-outer outer-'+this.id+'">';this.extraStyle=this._createExtraStyle();window.setTimeout(function(){(b=a._checkIfMovingNecessary())?a._makeMovable(b):M.Logger.log("Width not big enough to move",
M.INFO)},0)}else M.Logger.log('"time" OR "pxPerSec" are needed',M.WARN);this.html+='<div id="'+this.id+'"'+this.style()+">";if(this.hyperlinkTarget&&this.hyperlinkType)switch(this.hyperlinkType){case M.HYPERLINK_EMAIL:this.html+='<a rel="external" href="mailto:'+this.hyperlinkTarget+'">';break;case M.HYPERLINK_WEBSITE:this.html+='<a rel="external" target="_blank" href="'+this.hyperlinkTarget+'">';break;case M.HYPERLINK_PHONE:this.html+='<a rel="external" href="tel:'+this.hyperlinkTarget+'">'}this.html+=
this.newLineToBreak?this.nl2br(this.tabToSpaces?this.tab2space(this.value):this.value):this.tabToSpaces?this.tab2space(this.value):this.value;if(this.hyperlinkTarget&&this.hyperlinkType)this.html+="</a>";this.html+="</div>";if(_.isObject(this.movable))this.html+="</div>";return this.html},renderUpdate:function(){var a=this;this.computeValue();$("#"+this.id).html(this.newLineToBreak?this.nl2br(this.value):this.value);if(_.isObject(this.movable))this.movable.time||this.movable.time===0||this.movable.pxPerSec||
this.movable.pxPerSec===0?window.setTimeout(function(){(diff=a._checkIfMovingNecessary())?a._makeMovable(diff):M.Logger.log("Width not big enough to move",M.INFO)},0):M.Logger.log('"time" OR "pxPerSec" are needed',M.WARN)},_makeMovable:function(a){var b=this;window.setTimeout(function(){b._insertMoveRules(b._getBrowserKeyframeRule(),a,b.movable.offset||b.movable.offset===0?b.movable.offset:0,b.movable.pxPerSec?a/b.movable.pxPerSec:b.movable.time)},0)},_checkIfMovingNecessary:function(){var a;this.$this=
$("#"+this.id);this.$parent=this.$this.parent();this._addMoveClasses(this.$this,this.$parent);a=this._getDiff(this.$this,this.$parent);if(a>0){this.moveRulesAvailable&&this._deleteMoveRules();return a}else{this._removeMoveClasses(this.$this,this.$parent);this.moveRulesAvailable&&this._deleteMoveRules();return NO}},_createExtraStyle:function(){var a=document.createElement("style");a.type="text/css";document.getElementsByTagName("head").item(0).appendChild(a);return a=document.styleSheets[document.styleSheets.length-
1]},_getDiff:function(a,b){return a.outerWidth()-b.width()},_getBrowserKeyframeRule:function(){return CSSRule.WEBKIT_KEYFRAME_RULE?"-webkit-":CSSRule.MOZ_KEYRAME_RULE?"-moz-":CSSRule.O_KEYFRAME_RULE?"-o-":""},_addMoveClasses:function(a,b){a.addClass("tmp-movable-inner inner-"+this.id);b.addClass("tmp-movable-outer")},_removeMoveClasses:function(a,b){a.removeClass("tmp-movable-inner inner-"+this.id);b.removeClass("tmp-movable-outer")},_insertMoveRules:function(a,b,c,d){this.extraStyle.insertRule(".inner-"+
this.id+" {"+a+"animation-name: move-"+this.id+";"+a+"animation-duration: "+d+"s;"+a+"animation-iteration-count: infinite;"+a+"animation-timing-function: linear;}",0);this.extraStyle.insertRule("@"+a+"keyframes move-"+this.id+"{ 0%,100% { left: "+c+"px;} 50% { left:"+(-b-c)+"px;}}",1);this.moveRulesAvailable=YES},_deleteMoveRules:function(){for(var a=this.extraStyle.cssRules.length;a>0;){this.extraStyle.removeRule(a-1);a=this.extraStyle.cssRules.length}this.moveRulesAvailable=NO},style:function(){var a=
"";if(this.isInline)a+=' style="display:inline;"';if(this.cssClass)a+=' class="'+this.cssClass+'"';return a},setValue:function(a){this.value=a;this.renderUpdate()}});
M.CanvasView=M.View.extend({type:"M.CanvasView",recommendedEvents:["tap"],render:function(){return this.html='<canvas id="'+this.id+'" ></canvas>'},renderUpdate:function(){},getCanvas:function(){return $("#"+this.id).get(0)},getContext:function(a){return $("#"+this.id).get(0).getContext(a)},setSize:function(a,b){this.setWidth(a);this.setHeight(b)},setWidth:function(a){$("#"+this.id).get(0).width=a},getWidth:function(){return $("#"+this.id).get(0).width},setHeight:function(a){$("#"+this.id).get(0).height=
a},getHeight:function(){return $("#"+this.id).get(0).height}});
M.ButtonView=M.View.extend({type:"M.ButtonView",isActive:NO,isIconOnly:NO,hyperlinkType:null,hyperlinkTarget:null,tag:null,dataTheme:"",recommendedEvents:["click","tap","vclick"],render:function(){this.computeValue();this.html='<a data-role="button" id="'+this.id+'"'+this.style()+" ";if(this.hyperlinkTarget&&this.hyperlinkType)switch(this.hyperlinkType){case M.HYPERLINK_EMAIL:this.html+='rel="external" href="mailto:'+this.hyperlinkTarget+'"';break;case M.HYPERLINK_WEBSITE:this.html+='rel="external" target="_blank" href="'+
this.hyperlinkTarget+'"';break;case M.HYPERLINK_PHONE:this.html+='rel="external" href="tel:'+this.hyperlinkTarget+'"'}else this.html+='href="#"';this.html+=">"+this.value+"</a>";return this.html},registerEvents:function(){if(!this.internalEvents)this.internalEvents={tap:{target:this,action:"dispatchEvent"}};this.bindToCaller(this,M.View.registerEvents)()},renderUpdate:function(){this.computeValue();$("#"+this.id+" .ui-btn-text").text(this.value)},setValue:function(a){this.value=a;this.renderUpdate()},
theme:function(){$("#"+this.id).hasClass("ui-btn")||$("#"+this.id).buttonMarkup()},style:function(){var a="";if(this.isInline)a+=' data-inline="true"';if(this.icon)a+=' data-icon="'+this.icon+'"';if(this.cssClass)a+=' class="'+this.cssClass+'"';if(this.dataTheme)a+=' data-theme="'+this.dataTheme+'"';if(this.isIconOnly)a+=' data-iconpos="notext"';if(this.cssStyle)a+='style="'+this.cssStyle+'"';return a},dispatchEvent:function(a,b,c){this.isEnabled&&c&&M.EventDispatcher.callHandler(c,b,YES)},disable:function(){if(this.isEnabled){var a=
$("#"+this.id).html();a='<div data-theme="c" class="ui-shadow ui-disabled" aria-disabled="true">'+a+"</div>";$("#"+this.id).html(a);this.isEnabled=NO}},enable:function(){if(!this.isEnabled){var a=$("#"+this.id+" div").html();$("#"+this.id).html(a);this.isEnabled=YES}}});m_require("ui/button.js");
M.ListItemView=M.View.extend({type:"M.ListItemView",inEditMode:NO,hasSingleAction:YES,deleteButton:M.ButtonView.design({icon:"delete",value:""}),isDivider:NO,recommendedEvents:["tap"],isSelectable:YES,swipeButton:null,render:function(){this.html='<li id="'+this.id+'"'+this.style();if(this.isDivider)this.html+=' data-role="list-divider"';this.html+=">";if(this.childViews)if(this.inEditMode){this.html+='<a href="#">';this.renderChildViews();this.html+="</a>";this.html+=this.deleteButton.render()}else if(this.isSelectable){this.html+=
'<a href="#">';this.renderChildViews();this.html+="</a>"}else this.renderChildViews();else if(this.value)this.html+=this.value;this.html+="</li>";return this.html},renderChildViews:function(){if(this.childViews){var a=this.getChildViewsAsArray(),b;for(b in a){var c=this[a[b]];if(c){c._name=a[b];c.parentView=this;this.html+=c.type==="M.ButtonView"?"<div>"+c.render()+"</div>":c.render()}else{this.childViews=this.childViews.replace(a[b]," ");M.Logger.log("There is no child view '"+a[b]+"' available for "+
this.type+" ("+(this._name?this._name+", ":"")+"#"+this.id+")! It will be excluded from the child views and won't be rendered.",M.WARN)}}return this.html}},registerEvents:function(){this.internalEvents={tap:{target:this.parentView,action:"setActiveListItem"}};this.swipeButton&&$.extend(this.internalEvents,{swipeleft:{target:this.parentView,action:"showSwipeButton"},swiperight:{target:this.parentView,action:"showSwipeButton"}});this.bindToCaller(this,M.View.registerEvents)()},style:function(){var a=
"";if(this.cssClass)a+=' class="'+this.cssClass+'"';return a},swipeButtonClicked:function(a,b,c){a=this.id;var d=M.ViewManager.getViewById(a).modelId;c&&M.EventDispatcher.callHandler(c,b,NO,[a,d])}});M.TWO_COLUMNS={cssClass:"ui-grid-a",columns:{0:"ui-block-a",1:"ui-block-b"}};M.THREE_COLUMNS={cssClass:"ui-grid-b",columns:{0:"ui-block-a",1:"ui-block-b",2:"ui-block-c"}};M.FOUR_COLUMNS={cssClass:"ui-grid-c",columns:{0:"ui-block-a",1:"ui-block-b",2:"ui-block-c",3:"ui-block-d"}};
M.GridView=M.View.extend({type:"M.GridView",layout:null,cssClass:"",render:function(){this.html='<div id="'+this.id+'" '+this.style()+">";this.renderChildViews();this.html+="</div>";return this.html},renderChildViews:function(){if(this.childViews)if(this.layout){var a=this.childViews.split(" "),b;for(b in this.layout.columns)if(this[a[b]]){this.html+='<div class="'+this.layout.columns[b]+'">';this[a[b]]._name=a[b];this.html+=this[a[b]].render();this.html+="</div>"}}else M.Logger.log("No layout specified for GridView ("+
this.id+")!",M.WARN)},theme:function(){this.themeChildViews()},style:function(){if(this.layout)return'class="'+this.layout.cssClass+" "+this.cssClass+'"'}});
M.SearchBarView=M.View.extend({type:"M.SearchBarView",isListViewSearchBar:NO,listView:null,initialText:"",recommendedEvents:["focus","blur","enter","keyup"],render:function(){return this.html='<input id="'+this.id+'" type="search" value="'+(this.value?this.value:this.initialText)+'" class="'+this.cssClass+'" />'},registerEvents:function(){this.internalEvents={focus:{target:this,action:"gotFocus"},blur:{target:this,action:"lostFocus"},keyup:{target:this,action:"setValueFromDOM"}};this.bindToCaller(this,
M.View.registerEvents)()},renderUpdate:function(){$("#"+this.id).val(this.value);this.styleUpdate()},setValueFromDOM:function(a,b,c){this.value=this.secure($("#"+this.id).val());this.delegateValueUpdate();c&&M.EventDispatcher.callHandler(c,b,YES)},style:function(){var a="";if(this.isListViewSearchBar)a+=' class="ui-listview-filter"';return a},styleUpdate:function(){this.isInline?$("#"+this.id).attr("display","inline"):$("#"+this.id).removeAttr("display");this.isEnabled?$("#"+this.id).removeAttr("disabled"):
$("#"+this.id).attr("disabled","disabled")},gotFocus:function(){if(this.initialText&&(!this.value||this.initialText===this.value)){this.setValue("");this.cssClassOnInit&&this.removeCssClass(this.cssClassOnInit)}this.hasFocus=YES},lostFocus:function(){if(this.initialText&&!this.value){this.setValue(this.initialText,NO);this.value="";this.cssClassOnInit&&this.addCssClass(this.cssClassOnInit)}this.hasFocus=NO},setValue:function(a,b){this.value=a;this.renderUpdate();b&&this.delegateValueUpdate()},disable:function(){this.isEnabled=
NO;this.renderUpdate()},enable:function(){this.isEnabled=YES;this.renderUpdate()},clearValue:function(){this.setValue("");this.lostFocus()},theme:function(){this.initialText&&!this.value&&this.cssClassOnInit&&this.addCssClass(this.cssClassOnInit);var a=this;$("#"+this.id).siblings("a.ui-input-clear").bind("tap",function(){a.setValue("",YES)})},getValue:function(){return this.value}});m_require("ui/search_bar.js");
M.ListView=M.View.extend({type:"M.ListView",removeItemsOnUpdate:YES,isDividedList:NO,cssClassForDivider:null,isCountedList:NO,cssClassForCounter:null,cssClassForSplitView:null,items:null,inEditMode:NO,editOptions:null,isNumberedList:NO,listItemTemplateView:null,isInset:NO,doNotOverlapAtTop:NO,doNotOverlapAtBottom:NO,searchBar:M.SearchBarView,hasSearchBar:NO,usesDefaultSearchBehaviour:YES,searchBarInitialText:"Search...",onSearchStringDidChange:null,idName:null,selectedItem:null,swipeButton:null,useIndexAsId:NO,
render:function(){if(!M.ViewManager.currentlyRenderedPage.listList)M.ViewManager.currentlyRenderedPage.listList=[];M.ViewManager.currentlyRenderedPage.listList.push(this);if(this.hasSearchBar&&!this.usesDefaultSearchBehaviour){this.searchBar.isListViewSearchBar=YES;this.searchBar.listView=this;this.searchBar=M.SearchBarView.design(this.searchBar);this.html=this.searchBar.render()}else this.html="";var a=this.isNumberedList?"ol":"ul";this.html+="<"+a+' id="'+this.id+'" data-role="listview"'+this.style()+
"></"+a+">";return this.html},registerEvents:function(){this.bindToCaller(this,M.View.registerEvents)();this.hasSearchBar&&!this.usesDefaultSearchBehaviour&&this.searchBar.registerEvents()},addItem:function(a){$("#"+this.id).append(a)},removeAllItems:function(){$("#"+this.id).find("> li").each(function(){M.ViewManager.getViewById($(this).attr("id")).destroy()});$("#"+this.id).empty()},renderUpdate:function(){this.removeItemsOnUpdate&&this.removeAllItems();var a=this;if(this.contentBinding&&typeof this.contentBinding.target===
"object"&&typeof this.contentBinding.property==="string"&&this.value){var b=this.value,c=this.listItemTemplateView;if(c){c.events=c.events?c.events:this.events;if(this.items)b=b[this.items];if(this.isDividedList)_.isArray(b)?_.each(b,function(d){a.renderListItemDivider(d.label);a.renderListItemView(d.items,c)}):_.each(b,function(d,h){a.renderListItemDivider(h);a.renderListItemView(d,c)});else this.renderListItemView(b,c);this.themeUpdate()}else M.Logger.log("The template view could not be loaded! Maybe you forgot to use m_require to set up the correct load order?",
M.ERR)}else M.Logger.log("The specified content binding for the list view ("+this.id+") is invalid!",M.WARN)},renderListItemDivider:function(a){var b=M.ListItemView.design({});b.value=a;b.isDivider=YES;this.addItem(b.render());b.theme()},renderListItemView:function(a,b){var c=this;_.each(a,function(d,h){var i=b.design({});if(c.useIndexAsId&&typeof h==="number")i.modelId=h;else if(d.type==="M.Model")i.modelId=c.idName?d.get(c.idName):d.m_id;else if(c.idName)i.modelId=d[c.idName]||undefined;else if(d.id)i.modelId=
d.id;else if(typeof h==="number")i.modelId=h;i=c.cloneObject(i,d);i.value=d;if(c.inEditMode){i.inEditMode=c.inEditMode;i.deleteButton=i.deleteButton.design({modelId:i.modelId,events:{tap:{target:c.editOptions.target,action:c.editOptions.action}},internalEvents:{tap:{target:c,action:"removeListItem"}}})}i.parentView=c;c.addItem(i.render());i.registerEvents();i.deleteButton&&i.deleteButton.registerEvents();var l=i.getChildViewsAsArray(),n;for(n in i.getChildViewsAsArray())i[l[n]].theme()})},cloneObject:function(a,
b){var c=a.childViews?a.getChildViewsAsArray():[],d=b.type==="M.Model"?b.record:b,h;for(h in c){a[c[h]]=a[c[h]].design({});a[c[h]]=this.cloneObject(a[c[h]],b);var i=a[c[h]].computedValue?a[c[h]].computedValue.valuePattern:a[c[h]].valuePattern,l=/<%=\s+([.|_|-|$|\u00a7|@|a-zA-Z0-9\s]+)\s+%>/.exec(i);if(l)switch(a[c[h]].type){case "M.LabelView":case "M.ButtonView":case "M.ImageView":case "M.TextFieldView":for(;l!==null;)if(typeof d[l[1]]==="object"){i=d[l[1]];l=null}else{i=i.replace(l[0],d[l[1]]);l=
/<%=\s+([.|_|-|$|\u00a7|@|a-zA-Z0-9\s]+)\s+%>/.exec(i)}a[c[h]].value=i}}a.item=b;_.each(Object.keys(b),function(n){a.hasOwnProperty(n)||(a[n]=b[n])});return a},theme:function(){$("#"+this.id).listview();if(this.searchBar){if($("#"+this.id)&&$("#"+this.id).parent()){var a=0;$("#"+this.id).parent().find("form.ui-listview-filter").each(function(){a+=1;a!=1&&$(this).remove()})}this.searchBar.theme()}},themeUpdate:function(){$("#"+this.id).listview("refresh")},toggleRemove:function(a){if(this.contentBinding&&
typeof this.contentBinding.target==="object"&&typeof this.contentBinding.property==="string"&&this.contentBinding.target[this.contentBinding.property]){this.inEditMode=!this.inEditMode;this.editOptions=a;this.renderUpdate()}},setActiveListItem:function(a,b,c){if(this.swipeButton)this.hideSwipeButton();else{this.selectedItem&&this.selectedItem.removeCssClass("ui-btn-active");this.selectedItem=M.ViewManager.getViewById(a);if(!this.listItemTemplateView||this.listItemTemplateView&&this.listItemTemplateView.isSelectable)this.selectedItem.addCssClass("ui-btn-active");
c&&M.EventDispatcher.callHandler(c,b,NO,[a,this.selectedItem.modelId])}},resetActiveListItem:function(){this.selectedItem&&this.selectedItem.removeCssClass("ui-btn-active")},style:function(){var a="";if(this.cssClass||this.doNotOverlapAtTop||this.doNotOverlapAtBottom)a+=' class="'+(this.cssClass?this.cssClass:"")+(!this.isInset&&this.doNotOverlapAtTop?" listview-do-not-overlap-at-top":"")+(!this.isInset&&this.doNotOverlapAtBottom?" listview-do-not-overlap-at-bottom":"")+'"';if(this.isDividedList&&
this.cssClassForDivider)a+=' data-dividertheme="'+this.cssClassForDivider+'"';if(this.isInset)a+=' data-inset="true"';if(this.isCountedList&&this.cssClassForCounter)a+=' data-counttheme="'+this.cssClassForCounter+'"';if(this.cssClassForSplitView)a+=' data-splittheme="'+this.cssClassForSplitView+'"';if(this.hasSearchBar&&this.usesDefaultSearchBehaviour)a+=' data-filter="true" data-filter-placeholder="'+this.searchBarInitialText+'"';return a},removeListItem:function(a,b,c){var d=M.ViewManager.getViewById(a).modelId;
c&&M.EventDispatcher.callHandler(c,b,NO,[a,d])},showSwipeButton:function(a){var b=M.ViewManager.getViewById(a);this.resetActiveListItem();if(b.swipeButton){var c=this.swipeButton?this.swipeButton.parentView:null;c&&this.hideSwipeButton();if(!c){this.swipeButton=M.ButtonView.design(b.swipeButton);this.swipeButton.value=this.swipeButton.value?this.swipeButton.value:"delete";this.swipeButton.parentView=M.ViewManager.getViewById(a);this.swipeButton.cssClass=this.swipeButton.cssClass?this.swipeButton.cssClass+
" tmp-swipe-button":"a tmp-actionsheet-destructive-button tmp-swipe-button";this.swipeButton.value=this.swipeButton.value?this.swipeButton.value:"delete";this.swipeButton.internalEvents={tap:{target:b,action:"swipeButtonClicked"}};$("#"+a).append(this.swipeButton.render());this.swipeButton.theme();this.swipeButton.registerEvents();$("#"+this.swipeButton.id).css("height",0.7*$("#"+a).outerHeight());$("#"+this.swipeButton.id).css("top",Math.floor(0.15*$("#"+a).outerHeight()));$("#"+a+">div.ui-btn-inner").css("margin-right",
parseInt($("#"+this.swipeButton.id).css("width"))+parseInt($("#"+this.swipeButton.id).css("right")));var d=this;$("#"+M.ViewManager.getCurrentPage().id).bind("click tap",function(){d.hideSwipeButton()})}}else M.Logger.log("You need to specify a valid button with the 'swipeButton' property of your list template!",M.WARN)},hideSwipeButton:function(){$("#"+this.swipeButton.id).hide();$("#"+this.swipeButton.id).parent("li").find("div.ui-btn-inner").css("margin-right",0);this.swipeButton=null;$("#"+M.ViewManager.getCurrentPage().id).unbind("click tap")},
getListItemViewById:function(a){return _.detect(this.childViewObjects,function(b){return b.modelId===a})},updateListItemView:function(a,b){var c=this.getListItemViewById(a);if(c)b&&typeof b==="object"?_.each(b,function(d){var h=M.ViewManager.getView(c,d.key);h?h.setValue(d.value):M.Logger.log("There is no view '"+d.key+"' available within the list item.",M.WARN)}):M.Logger.log("No updates specified when calling 'updateListItemView'.",M.WARN);else M.Logger.log("No list item found with given id '"+
a+"'.",M.WARN)}});
M.DashboardView=M.View.extend({type:"M.DashboardView",itemsPerLine:3,recommendedEvents:["click","tap"],items:[],isEditable:NO,isInEditMode:NO,name:"dashboard",touchPositions:null,latestTouchEventType:null,render:function(){this.html='<div id="'+this.id+'"'+this.style()+">";this.renderChildViews();this.html+="</div>";this.html+='<div class="tmp-dashboard-line-clear"></div>';this.touchPositions={};return this.html},renderChildViews:function(){if(this.childViews){var a=this.getChildViewsAsArray(),b;
for(b in a){this[a[b]].parentView=this;this[a[b]]._name=a[b];this.html+=this.renderDashboardItemView(this[a[b]],b)}}},renderUpdate:function(){if(this.contentBinding){this.removeAllItems();var a=localStorage.getItem(M.LOCAL_STORAGE_PREFIX+M.Application.name+M.LOCAL_STORAGE_SUFFIX+"dashboard");a=a?JSON.parse(a):null;this.items=[];a=a&&this.value&&a.length==this.value.length?this.sortItemsByValues(this.value,a):this.value;var b="",c;for(c in a)b+=this.renderDashboardItemView(a[c],c);this.addItems(b);
for(c in this.items)this.items[c].registerEvents()}},addItems:function(a){$("#"+this.id).append(a)},removeAllItems:function(){$("#"+this.id).empty()},renderDashboardItemView:function(a,b){if(a&&a.value&&a.icon){var c=a.type==="M.DashboardItemView"?a:M.DashboardItemView.design({value:a.value?a.value:"",icon:a.icon?a.icon:"",label:a.label?a.label:a.value?a.value:"",parentView:this,events:a.events}),d="";this.items.push(c);if(b%this.itemsPerLine===0)d+='<div class="tmp-dashboard-line">';c.cssStyle="width: "+
100/this.itemsPerLine+"%";d+=c.render();if(b%this.itemsPerLine===this.itemsPerLine-1)d+='</div><div class="tmp-dashboard-line-clear"></div>';return d}else M.Logger.log("Childview of dashboard is no valid dashboard item.",M.WARN)},dispatchTapEvent:function(a,b,c){c&&M.EventDispatcher.callHandler(c,b,YES);this.events&&this.events.tap&&M.EventDispatcher.callHandler(this.events.tap,b,YES);this.latestTapEventTimestamp=+new Date},editDashboard:function(a,b){this.touchPositions.touchstart={};if(!(!this.isEditable||
this.latestTapEventTimestamp>+new Date-500))if(this.isInEditMode&&b)this.stopEditMode();else if(!this.isInEditMode&&b||this.isInEditMode&&!b){M.EventDispatcher.unregisterEvents(this.id);this.isInEditMode=YES;_.each(this.items,function(c){c.addCssClass("rotate"+M.Math.random(1,2));M.EventDispatcher.unregisterEvents(c.id);if($.support.touch){M.EventDispatcher.registerEvent("touchstart",c.id,{target:c.parentView,action:"editTouchStart"},c.recommendedEvents);M.EventDispatcher.registerEvent("touchend",
c.id,{target:c.parentView,action:"editTouchEnd"},c.recommendedEvents);M.EventDispatcher.registerEvent("touchmove",c.id,{target:c.parentView,action:"editTouchMove"},c.recommendedEvents)}else{M.EventDispatcher.registerEvent("mousedown",c.id,{target:c.parentView,action:"editMouseDown"},c.recommendedEvents);M.EventDispatcher.registerEvent("mouseup",c.id,{target:c.parentView,action:"editMouseUp"},c.recommendedEvents)}})}},stopEditMode:function(){this.isInEditMode=NO;_.each(this.items,function(a){a.removeCssClass("rotate1");
a.removeCssClass("rotate2");M.EventDispatcher.unregisterEvents(a.id);a.registerEvents()})},setValue:function(a){this.value=a;var b=[];_.each(a,function(c){b.push(c.value)});localStorage&&localStorage.setItem(M.LOCAL_STORAGE_PREFIX+M.Application.name+M.LOCAL_STORAGE_SUFFIX+"dashboard",JSON.stringify(b))},sortItemsByValues:function(a,b){var c=[];_.each(b,function(d){_.each(a,function(h){h.value===d&&c.push(h)})});return c},editTouchStart:function(a,b){this.latestTouchEventType="touchstart";var c=b.originalEvent?
b.originalEvent.changedTouches?b.originalEvent.changedTouches[0]:null:null;this.touchPositions.touchstart={x:c.clientX,y:c.clientY,date:+new Date};var d=this;window.setTimeout(function(){d.latestTouchEventType==="touchstart"&&d.stopEditMode()},750)},editTouchMove:function(a,b){this.latestTouchEventType="touchmove";var c=b.originalEvent?b.originalEvent.changedTouches?b.originalEvent.changedTouches[0]:null:null;if(c){var d=c.pageX-parseInt($("#"+a).css("width"))/2;c=c.pageY-parseInt($("#"+a).css("height"))/
2;$("#"+a).css("position","absolute");$("#"+a).css("left",d+"px");$("#"+a).css("top",c+"px")}},editTouchEnd:function(a,b){this.latestTouchEventType="touchend";if(b.currentTarget.id){var c=[];_.each(this.items,function(h){c.push({id:h.id,x:$("#"+h.id).position().left,y:$("#"+h.id).position().top,item:h});c.sort(function(i,l){return Math.abs(i.y-l.y)<30?i.x<l.x?-1:1:i.y<l.y?-1:1})});var d=[];_.each(c,function(h){d.push(h.item)});this.setValue(d);this.renderUpdate();this.isInEditMode&&this.editDashboard()}},
editMouseDown:function(a,b){this.latestTouchEventType="mousedown";this.touchPositions.touchstart={x:b.clientX,y:b.clientY,date:+new Date};M.EventDispatcher.registerEvent("mousemove",a,{target:this,action:"editMouseMove"},M.ViewManager.getViewById(a).recommendedEvents);var c=this;window.setTimeout(function(){c.latestTouchEventType==="mousedown"&&c.stopEditMode()},750)},editMouseMove:function(a,b){this.latestTouchEventType="mousemove";var c=b.pageX-parseInt($("#"+a).css("width"))/2,d=b.pageY-parseInt($("#"+
a).css("height"))/2;$("#"+a).css("position","absolute");$("#"+a).css("left",c+"px");$("#"+a).css("top",d+"px")},editMouseUp:function(a,b){this.latestTouchEventType="mouseup";if(b.currentTarget.id){var c=[];_.each(this.items,function(h){M.EventDispatcher.unregisterEvent("mousemove",h.id);c.push({id:h.id,x:$("#"+h.id).position().left,y:$("#"+h.id).position().top,item:h});c.sort(function(i,l){return Math.abs(i.y-l.y)<30?i.x<l.x?-1:1:i.y<l.y?-1:1})});var d=[];_.each(c,function(h){d.push(h.item)});this.setValue(d);
this.renderUpdate();this.isInEditMode&&this.editDashboard()}},style:function(){var a="";if(this.cssClass)a+=' class="tmp-dashboard '+this.cssClass+'"';return a}});M.INPUT_TEXT="text";M.INPUT_PASSWORD="password";M.INPUT_NUMBER="number";M.INPUT_TELEPHONE="tel";M.INPUT_URL="url";M.INPUT_EMAIL="email";M.INPUT_TIME="time";M.INPUT_DATE="date";M.INPUT_MONTH="month";M.INPUT_WEEK="week";M.INPUT_DATETIME="datetime";M.INPUT_DATETIME_LOCAL="datetime-local";
M.TextFieldView=M.View.extend({type:"M.TextFieldView",name:null,label:null,initialText:"",isGrouped:NO,hasMultipleLines:NO,inputType:M.INPUT_TEXT,dateInputTypes:[M.INPUT_DATETIME,M.INPUT_DATE,M.INPUT_MONTH,M.INPUT_WEEK,M.INPUT_TIME,M.INPUT_DATETIME_LOCAL],numberOfChars:null,useNativeImplementationIfAvailable:YES,recommendedEvents:["focus","blur","enter","keyup","tap"],hasAsteriskOnLabel:NO,cssClassForAsterisk:null,render:function(){this.computeValue();this.html="";if(this.label){this.html+='<label for="'+
(this.name?this.name:this.id)+'">'+this.label;this.html+=this.hasAsteriskOnLabel?this.cssClassForAsterisk?'<span class="'+this.cssClassForAsterisk+'">*</span></label>':"<span>*</span></label>":"</label>"}var a="";if(this.initialText)a=' placeholder="'+this.initialText+'" ';if(this.hasMultipleLines)this.html+='<textarea cols="40" rows="8" name="'+(this.name?this.name:this.id)+'" id="'+this.id+'"'+this.style()+a+">"+(this.value?this.value:"")+"</textarea>";else{var b=this.inputType;if(_.include(this.dateInputTypes,
this.inputType)&&!this.useNativeImplementationIfAvailable)b="text";this.html+="<input "+(this.numberOfChars?'maxlength="'+this.numberOfChars+'"':"")+a+'type="'+b+'" name="'+(this.name?this.name:this.id)+'" id="'+this.id+'"'+this.style()+' value="'+(this.value?this.value:"")+'" />'}return this.html},registerEvents:function(){this.internalEvents={focus:{target:this,action:"gotFocus"},blur:{target:this,action:"lostFocus"},keyup:{target:this,action:"setValueFromDOM"}};if(_.include(this.dateInputTypes,
this.inputType)&&!this.useNativeImplementationIfAvailable)this.internalEvents.tap={target:this,action:"handleTap"};this.bindToCaller(this,M.View.registerEvents)()},contentDidChange:function(){if(!this.hasFocus){this.bindToCaller(this,M.View.contentDidChange)();this.renderUpdate();this.delegateValueUpdate()}},renderUpdate:function(a){a||this.computeValue();$("#"+this.id).val(this.value);this.styleUpdate()},handleTap:function(a,b,c){if(_.include(this.dateInputTypes,this.inputType)&&(!M.Environment.supportsInputType(this.inputType)||
!this.useNativeImplementationIfAvailable))M.DatePickerView.show({source:this,useSourceDateAsInitialDate:YES,showDatePicker:this.inputType!==M.INPUT_TIME,showTimePicker:this.inputType===M.INPUT_TIME||this.inputType===M.INPUT_DATETIME||this.inputType===M.INPUT_DATETIME_LOCAL,dateOrder:this.inputType===M.INPUT_MONTH?M.DatePickerView.dateOrderMonthOnly:M.DatePickerView.dateOrder,dateFormat:this.inputType===M.INPUT_MONTH?M.DatePickerView.dateFormatMonthOnly:M.DatePickerView.dateFormat});c&&M.EventDispatcher.callHandler(c,
b,YES)},gotFocus:function(a,b,c){this.hasFocus=YES;c&&M.EventDispatcher.callHandler(c,b,YES)},lostFocus:function(a,b,c){this.setValueFromDOM();this.hasFocus=NO;c&&M.EventDispatcher.callHandler(c,b,YES)},style:function(){var a=' style="';if(this.isInline)a+="display:inline;";a+='"';this.isEnabled||(a+=' disabled="disabled"');if(this.cssClass)a+=' class="'+this.cssClass+'"';return a},theme:function(){var a=$("#"+this.id);if(this.value){a.trigger("keyup").textinput();this.isEnabled||a.textinput("disable")}a.parent().addClass(this.cssClass+
"_container")},styleUpdate:function(){if(this.value){$("#"+this.id).removeAttr("disabled");$("#"+this.id).trigger("keyup")}this.isInline?$("#"+this.id).attr("display","inline"):$("#"+this.id).removeAttr("display");this.isEnabled?$("#"+this.id).removeAttr("disabled"):$("#"+this.id).attr("disabled","disabled")},setValueFromDOM:function(a,b,c){this.value=this.secure($("#"+this.id).val());this.delegateValueUpdate();c&&M.EventDispatcher.callHandler(c,b,YES)},setValue:function(a,b,c){this.value=a;this.renderUpdate(c);
b&&this.delegateValueUpdate()},disable:function(){this.isEnabled=NO;this.renderUpdate()},enable:function(){this.isEnabled=YES;this.renderUpdate()},clearValue:function(){this.setValue("");this.lostFocus()},getValue:function(){return this.value},setLabel:function(a){this.label&&$('label[for="'+this.id+'"]').html(a)}});
